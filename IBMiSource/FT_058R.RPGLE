000100210707
000200210607       Ctl-opt option(*nodebugio:*srcstmt:*nounref)   DftActGrp(*no);
000300210607
000400210607      *-------------------------------------------------------------------------
000500210607      *
000600210726      *  Description: Manually Run the HCI Credit Files
000700210607      *  Programmer.: Brian Rees
000800210726      *  Date.......: 07/26/2021
000900210607      *
001000210607      *-------------------------------------------------------------------------
001100210607
001200210607      *-------------------------------------------------------------------------
001300210607      *
001400210607      * Declare Files
001500210607      *
001600210607      *-------------------------------------------------------------------------
001700210726       Dcl-f FT_058D  WorkStn
001800210607          Handler('PROFOUNDUI(HANDLER)');
001900210607
002700210607
002800210607      *-------------------------------------------------------------------------
002900210607      *
003000210607      * Global Variables
003100210607      *
003200210607      *-------------------------------------------------------------------------
003300210607
003900210607
006800210726       dcl-pr FT_058C1 ExtPgm('FT_058C1');
006801210726         pdate   Char(8);
006802210726         pFileFound Char(1);
006803210726       End-Pr;
006804210726       dcl-s pDate   Char(8);
006805210726       dcl-s pFileFound Char(1);
006806210726
006807210726
006900210607
007000210706      *-------------------------------------------------------------------------
007100210706      *
007200210706      * *Entry Procedure
007300210706      *
007400210706      *-------------------------------------------------------------------------
009000210607
009100210607
009200210607      *-------------------------------------------------------------------------
009300210607      *
009400210607      * Mainline Program
009500210607      *
009600210607      *-------------------------------------------------------------------------
009800210706
010300210706       dou btnExit = *on;
010400210706
010500210707         exfmt Screen1;
010501210726         pFileFound = '';
010600210726         s1Msg = '';
010601210726         s1Color = '';
010700210707
010701210726
010702210726
010800210706         if btnExit = *on;
010900210706           leave;
011000210706         EndIf;
011100210706
011800210706
011900210707
012000210707         //----------------------------------------------
012100210707         //
012200210707         // Accept Button - Process Data.
012300210707         //
012400210707         //----------------------------------------------
012500210706         if btnAccept = *on;
012600210706
016300210707           //------------------------
016400210726           // Format the Date
016500210707           //------------------------
018600210726           pDate = %char(%date(s1Date:*usa/):*iso0);
021300210726
021301210726
021302210726           FT_058C1( pDate : pFileFound ) ;
021303210726
021304210726           if pFileFound = 'N';
021305210726             s1Msg = 'File Not Found on Server';
021306210726             s1Color = 'Red';
021308210726           EndIf;
021309210726
021310210726           if pFileFound = 'Y';
021311210726             s1Msg = 'File has been processed.';
021312210726             s1Color = 'Green';
021313210726           EndIf;
021314210726
021401210726         endif;
021500210707
021600210706       EndDo;
021700210706
022100210607
022200210706       *inlr = *on;
