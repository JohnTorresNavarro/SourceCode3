000100000407    ? *? COMPILE:
000200000407    ? *?   CRTBNDRPG  PGM(&O/&N) SRCFILE(&L/&F) DFTACTGRP(*NO) DBGVIEW(*SOURCE)
000300000000    ? *?________________________________________________________________________
000400000000    ? *?
000500000410    ? *? Description:  Update AACODE file
000600000000    ? *?
000700000000    ? *? (c)Copyright 1999 by Inovative Outsourcing, Inc.
000800000000    ? *? This document contains restricted materials of IO, Inc.
000900000000    ? *?
001000000000    ? *? History:
001100000000    ? *?__________________________________________________________________
001200000410    ?FFM140W    UF A E           K DISK    USROPN
001300000127     FTMPREF    IF   E             DISK
001400000000    ? *?__________________________________________________________________
001500000210    ?D WTOVR           S             80    DIM(1) CTDATA PERRCD(1)
001600000210    ?D WTM             S             80    DIM(2) CTDATA PERRCD(1)
001700000328    ?D WWDTA           S                   LIKE(WUDTA)
001800000328     D ISO_DATE        S               D   DATFMT(*ISO)
001900000328     D USA_DATE        S               D   DATFMT(*USA)
002000000000    ? *?__________________________________________________________________
002100000328    ? *?PROCEDURES
002200000328      /COPY QGPL/QRPGLESRC,SNDRPG_PR#
002300000328      /COPY QGPL/QRPGLESRC,SNDMSG_PR#
002400000000    ? *?
002500000000    ? *?RETREIVE JOB ATTRIBUTES API DATA STRUCTURE
002600000000    ?D WDJOBA          DS                  INZ
002700000000    ?D  WDBYTR                 1      4B 0
002800000000    ?D  WDBYTA                 5      8B 0
002900000000    ?D  WDJNAM                 9     18
003000000000    ?D  WDJUSR                19     28
003100000000    ?D  WDJNBR                29     34
003200000000    ?D  WDINJI                35     50
003300000000    ?D  WDJSTS                51     60
003400000000    ?D  WDJBTP                61     61
003500000000    ?D  WDJBST                62     62
003600000000    ?D  WDRVSD                63     64
003700000000    ?D  WDRNPY                65     68B 0
003800000000    ?D  WDTMSL                69     72B 0
003900000000    ?D  WDDFWT                73     76B 0
004000000000    ?D  WDPRGE                77     86
004100000000    ? *?API BINARY WORK FIELDS
004200000000    ?D                 DS
004300000328    ?D WDRCVL                  1      4B 0 INZ(86)
004400000328    ? *?
004500000328    ? *?Data structure
004600000410    ?D WUDTA         E DS                  EXTNAME(FM140W)
004700000328    ? *?
004800000000    ? *?Program status data structure
004900991108    ?D PGMD          ESDS                  EXTNAME(IOPGMD)
005000000000    ? *?__________________________________________________________________
005100000000    ? *?Open file
005200000210     C                   IF        WWOPN <> 'Y' AND
005300000210     C                             WIRQS <> 'INZRCD'
005400000210     C                   EXSR      OPNFIL
005500000210     C                   END
005600000000    ? *?
005700000000    ? *?Process I/O request
005800000210     C                   MOVE      *BLANKS       WORTN
005900000119     C                   SELECT
006000000119
006100000210     C                   WHEN      WIRQS = 'GET'
006200000119     C                   EXSR      GET
006300000119
006400000210     C                   WHEN      WIRQS = 'GETNL'
006500000119     C                   EXSR      GETNL
006600000119
006700000210     C                   WHEN      WIRQS = 'CHANGE'
006800000119     C                   EXSR      CHANGE
006900000119
007000000210     C                   WHEN      WIRQS = 'ADD'
007100000119     C                   EXSR      ADD
007200000119
007300000410     C*                  WHEN      WIRQS = 'DELETE'
007400000410     C*                  EXSR      DELETE
007500000119
007600000210     C                   WHEN      WIRQS = 'INZRCD'
007700000119     C                   EXSR      INZRCD
007800000119
007900000210     C                   WHEN      WIRQS = 'INZNKY'
008000000119     C                   EXSR      INZNKY
008100000119
008200000210     C                   WHEN      WIRQS = 'RELEASE'
008300000119     C                   EXSR      REL
008400000119
008500000210     C                   WHEN      WIRQS = 'OVRLAY'
008600000119     C                   EXSR      OVRLAY
008700000328
008800000328     C                   WHEN      WIRQS = 'EXIT  '
008900000328     C                   EXSR      EXIT
009000000119
009100000210     C                   WHEN      WIRQS <> 'END'
009200000119     C                   EXSR      PRCERR
009300000119
009400000210     C                   ENDSL
009500000000    ? *?
009600000000    ? *?Return to caller
009700000210     C                   IF        WIRQS = 'END'
009800000328     C                   MOVE      *ON           *INLR
009900000322    C                   ELSE
010000000210     C                   RETURN
010100000210     C                   END
010200000000    ? *?__________________________________________________________________
010300000322    ? *?Open file - Override XXPOVR      all usage, no sharing, forced write
010400000000    ? *?__________________________________________________________________
010500000210     C     OPNFIL        BEGSR
010600000000    ? *?RETRIEVE JOB ATTRIBUTES
010700000210    ?C                   CALL      'QUSRJOBI'
010800000210     C                   PARM                    WDJOBA
010900000210     C                   PARM                    WDRCVL
011000000210     C                   PARM      'JOBI0100'    WWFMTN
011100000210     C                   PARM      '*'           WWQJN
011200000210     C                   PARM                    WWIJI
011300000000    ? *?
011400000210     C                   IF        WDJBTP = 'I' OR
011500000210     C                             WDJBTP = 'B'
011600000113     C                   EVAL      WWLNG = 80
011700000210    ?C                   CALL      'QCMDEXC'                            99
011800000210     C                   PARM                    WTOVR
011900000210     C                   PARM                    WWLNG
012000000210     C                   END
012100000000    ? *?
012200000210     C                   IF        *IN99 = *OFF
012300000410    ?C                   OPEN      FM140W                               99
012400000210     C                   END
012500000000    ? *?
012600000210     C                   IF        *IN99 = *OFF
012700000210     C                   MOVE      'Y'           WWOPN
012800000210    C                   ELSE
012900000210     C                   MOVEL     'OPNERR'      WORTN
013000000210     C                   MOVE      WTM(1)        WWMSG
013100000215     C                   CALLP     SNDMSG
013200000210     C                   RETURN
013300000210     C                   END
013400000000    ? *?
013500000210     C                   ENDSR
013600000000    ? *?__________________________________________________________________
013700000000    ? *?Get record
013800000000    ? *?__________________________________________________________________
013900000210     C     GET           BEGSR
014000000410    ?C     WKDATA        CHAIN     FM140W                             9998
014100000000    ? *?
014200000127     C                   SELECT
014300000210     C                   WHEN      *IN99 = *ON
014400000210     C                   MOVEL     'GETERR'      WORTN
014500000119
014600000210     C                   WHEN      *IN98 = *ON
014700000210     C                   MOVEL     'NOTAVL'      WORTN
014800000210     C                   IF        WDJBTP = 'I'
014900000210     C                   EXSR      LCKMSG
015000000210     C                   END
015100000210     C                   ENDSL
015200000000    ? *?
015300000210     C                   ENDSR
015400000000    ? *?__________________________________________________________________
015500000000    ? *?Get record without a lock
015600000000    ? *?__________________________________________________________________
015700000210     C     GETNL         BEGSR
015800000410     C     WKDATA        CHAIN(N)  FM140W                             9999
015900000210     C                   IF        *IN99 = *ON
016000000210     C                   MOVEL     'GETERR'      WORTN
016100000210     C                   END
016200000210     C                   ENDSR
016300000000    ? *?__________________________________________________________________
016400000000    ? *?Release record
016500000000    ? *?__________________________________________________________________
016600000210     C     REL           BEGSR
016700000410     C                   UNLOCK    FM140W                               99
016800000210     C                   IF        *IN99 = *ON
016900000210     C                   MOVEL     'UNLERR'      WORTN
017000000210     C                   END
017100000210     C                   ENDSR
017200000000    ? *?__________________________________________________________________
017300000000    ? *?Add record
017400000000    ? *?__________________________________________________________________
017500000210     C     ADD           BEGSR
017600000410    ?C                   WRITE     AACODR                               99
017700000328     C     *IN99         IFEQ      *ON
017800000328     C                   MOVEL     'WRTERR'      WORTN
017900000210    C                   ELSE
018000000328     C                   MOVE      *BLANKS       WORTN
018100000328     C                   ENDIF
018200000210     C                   ENDSR
018300000000    ? *?__________________________________________________________________
018400000000    ? *?Change record
018500000000    ? *?__________________________________________________________________
018600000328     C     CHANGE        BEGSR
018700000410    ?C                   UPDATE    AACODR                               99
018800000328     C     *IN99         IFEQ      *ON
018900000328     C                   MOVEL     'UPDERR'      WORTN
019000000210    C                   ELSE
019100000328     C                   MOVE      *BLANKS       WORTN
019200000328     C                   ENDIF
019300000210     C                   ENDSR
019400000000    ? *?__________________________________________________________________
019500000000    ? *?Delete record
019600000000    ? *?__________________________________________________________________
019700000210     C     DELETE        BEGSR
019800000410    ?C     WKDATA        DELETE    AACODR                             9999
019900000328     C     *IN99         IFEQ      *ON
020000000328     C                   MOVEL     'DLTERR'      WORTN
020100000210    C                   ELSE
020200000328     C                   MOVE      *BLANKS       WORTN
020300000210     C                   END
020400000210     C                   ENDSR
020500000000    ? *?__________________________________________________________________
020600000000    ? *?Overlay record
020700000000    ? *?__________________________________________________________________
020800000210     C     OVRLAY        BEGSR
020900000210     C                   MOVEL     WUDTA         WWDTA
021000000210     C                   EXSR      GET
021100000113     C                   IF        WORTN = *BLANKS
021200000210     C                   MOVEL     WWDTA         WUDTA
021300000210     C                   EXSR      CHANGE
021400000210     C                   END
021500000210     C                   ENDSR
021600000000    ? *?__________________________________________________________________
021700000000    ? *?Initialize record
021800000000    ? *?__________________________________________________________________
021900000210     C     INZRCD        BEGSR
022000000410    ?C                   CLEAR                   AACODR
022100000210     C                   ENDSR
022200000000    ? *?__________________________________________________________________
022300000000    ? *?Initialize record except key
022400000000    ? *?__________________________________________________________________
022500000210     C     INZNKY        BEGSR
022600000410    ?C     *NOKEY        CLEAR                   AACODR
022700000210     C                   ENDSR
022800000328    ? *?__________________________________________________________________
022900000328    ? *?Exit - Program session ending.
023000000328    ? *?__________________________________________________________________
023100000328     C     EXIT          BEGSR
023200000328     C                   EVAL      WIRQS = 'END     '
023300000328     C                   ENDSR
023400000000    ? *?__________________________________________________________________
023500000000    ? *?Process error
023600000000    ? *?__________________________________________________________________
023700000210     C     PRCERR        BEGSR
023800000210     C                   MOVEL     'REQERR'      WORTN
023900000210     C                   MOVE      WTM(2)        WWMSG
024000000215     C                   CALLP     SNDMSG
024100000210     C                   ENDSR
024200000000    ? *?__________________________________________________________________
024300000000    ? *?Check for Lock Message
024400000000    ? *?__________________________________________________________________
024500000210     C     LCKMSG        BEGSR
024600000210     C     '00'          CAT       WQMSGD:0      WWMSG
024700000215     C                   CALLP     SNDMSG
024800000210     C                   ENDSR
024900000000    ? *?__________________________________________________________________
025000000000    ? *?Entry parameter list
025100000000    ? *?__________________________________________________________________
025200000210     C     PLIST         BEGSR
025300000210     C     *ENTRY        PLIST
025400000210     C                   PARM                    WIRQS
025500000210     C                   PARM                    WORTN
025600000210     C                   PARM                    WUDTA
025700000000     C                   ENDSR
025800000000    ? *?__________________________________________________________________
025900000000    ? *?Key lists
026000000000    ? *?__________________________________________________________________
026100000210     C     KLIST         BEGSR
026200000327     C     WKDATA        KLIST
026300000410     C                   KFLD                    ACODE
026400000000    ? *?
026500000000     C                   ENDSR
026600000000    ? *?__________________________________________________________________
026700000000    ? *?Initialize routine
026800000000    ? *?__________________________________________________________________
026900000210     C     *INZSR        BEGSR
027000000210     C                   ENDSR
027100000000    ? *?__________________________________________________________________
027200000000    ? *?Program error handler
027300000000    ? *?__________________________________________________________________
027400000215     C     *PSSR         BEGSR
027500000215     C                   CALLP     SNDRPG
027600000215     C                   ENDSR     '*CANCL'
027700000000    ? *?__________________________________________________________________
027800000131      *?PROCEDURES      ________________________________________________________
027900000308      /COPY QGPL/QRPGLESRC,SNDRPG#
028000000308      /COPY QGPL/QRPGLESRC,SNDMSG#
028100000000    ? *?__________________________________________________________________
028200000327** WTOVR
028301000410OVRDBF FILE(FM140W) TOFILE(*LIBL/FM140W) SHARE(*NO)
028400000000** WTM
02850000041000File can not be opened.  FM147  failed.
02860000041000Request not supported by program FM147.
