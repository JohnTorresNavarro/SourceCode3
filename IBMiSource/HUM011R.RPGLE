000100000000      *_________________________________________________________________________
000200000000      *
000300230710      *  Description:  Retrieve Cov Type
000400000000      *
000500230710      *  (c)Copyright 2023 by Amwins.
000600000000      *
000700230710      *    Created by:  JALLEN - July 10, 2023
000800000000      *_________________________________________________________________________
000900230710     FMCOV22    IF   E           K DISK    extfile('QS36F/F.MCOV22')
001000230706
001100230706     D wTrs            S              3S 0
001200230706     D wSub            S              3S 0
001300230710     D wAcc            S              4S 0
001400230710     D wSsn            S              9S 0
001500230706
001600000000      * Program status data structure
001700000000     D PGMD          ESDS                  EXTNAME(IOPGMD)
001800230706
001900230706     C     *Entry        Plist
002000230706     C                   Parm                    Trs               3
002100230706     C                   Parm                    Sub               3
002200230710     C                   Parm                    Acc               4
002300230710     C                   Parm                    Ssn               9
002400230710     C                   Parm                    Pln               4
002500230710     C                   Parm                    OutType           3
002600230706
002700230706     C                   eval      wTrs = %dec(Trs:3:0)
002800230706     C                   eval      wSub = %dec(Sub:3:0)
002900230706     C                   eval      wAcc = %dec(Acc:4:0)
003000230710     C                   eval      wSsn = %dec(Ssn:9:0)
003100230706
003200230710     C     CovKey        setll     MCOV22
003300230710     C     CovKey        reade     MCOV22
003400230710     C                   dow       not %eof(MCOV22)
003500230710     C                   If        CANDT = 0
003600230710     C                   eval      OutType = %trim(MCOVTP)
003700230710     C                   Leave
003800230706     C                   End
003900230710     C     CovKey        reade     MCOV22
004000230706     C                   enddo
004100230706
004200230706     C                   Return
004300000000      *___________________________________________________________________
004400000000      * Key Lists
004500000000      *___________________________________________________________________
004600000000     C     KLIST         BEGSR
004700230710     C     CovKey        Klist
004800230710     C                   Kfld                    wTrs
004900230710     C                   Kfld                    wSub
005000230710     C                   Kfld                    wAcc
005100230710     C                   Kfld                    wSsn
005200230710     C                   Kfld                    Pln
005300000000     C                   ENDSR
005400000000      *___________________________________________________________________
005500000000      * Program open
005600000000      *___________________________________________________________________
005700000000     C     *INZSR        BEGSR
005800000000     C                   ENDSR
005900000000      *___________________________________________________________________
006000000000      * Program error handler
006100000000      *___________________________________________________________________
006200000000     C     *PSSR         BEGSR
006300000000     C                   CALL      'SNDRPGM'                            50
006400000000     C                   PARM                    WQPGMN
006500000000     C                   PARM                    WQSTSC
006600000000     C                   PARM                    WQRPGS
006700000000     C                   PARM                    WQMSG
006800000000     C                   ENDSR     '*CANCL'
