000100180620       Ctl-opt option(*noDebugIo)   DftActGrp(*no)
000200180620          bnddir('GBSBIND' : 'GBSBDIR');
000300180620
000400180620      *-------------------------------------------------------------------------
000500180620      *
000600180620      *  Description:
000700180620      *  Programmer.:  Brian Rees
000800180620      *  Date.......:  06/20/2018
000900180620      *
001000180620      *-------------------------------------------------------------------------
001100180620
001200180620      *-------------------------------------------------------------------------
001300180620      *
001400180620      * Declare Files
001500180620      *
001600180620      *-------------------------------------------------------------------------
001700220829       Dcl-f GBS0037D2 WorkStn
001800180620          Handler('PROFOUNDUI(HANDLER)')
001900180620          SFILE(LstSFL:rrn);
002000180620
002100180620       Dcl-f Agenl1 keyed ExtDesc('F.AGENL1') ExtFile(*extdesc);
002200180620       Dcl-f Agency keyed
002300180620          ExtDesc('F.AGENCY') ExtFile(*extdesc)
002400180620          Rename( Agenr : Rcd1 )    ;
002500180620
002600180620       dcl-f rmgrmst0 keyed;
002700180620       dcl-f agcyrmg0 keyed;
002800180620
002900180620
003000180620      *-------------------------------------------------------------------------
003100180620      *
003200180620      * Global Variables
003300180620      *
003400180620      *-------------------------------------------------------------------------
003500180620       dcl-s rrn Zoned(5);
003600180620       dcl-s Reload Char(1) inz('Y');
003601220829
003602220829     d psds           sds
003603220829     d  proc_name        *proc
003604220829     d  jobName              244    253
003605220829     d  userName             254    263
003606220829     d  jobNumber            264    269
003607220829
003700180620
003800220829      *-------------------------------------------------------------------------
003801220829      *
003802220829      * *Entry Procedure
003803220829      *
003804220829      *-------------------------------------------------------------------------
003805220829       Dcl-pr Main ExtPgm;
003806220829         *N  Char(3);
003808220829         *n  Char(1);
003809220829       End-Pr;
003810220829
003811220829       dcl-pi Main;
003812220829         inAgency Char(3);
003814220829         inCancel Char(1);
003815220829       End-Pi;
003816220829
003817220829
003900180620      *------------------------------------------------------------------
004000180620      *
004100180620      * Procedures
004200180620      *
004300180620      *------------------------------------------------------------------
004400180620       /Include *LIBL/QMODSRC,PR0001RPR
004500180620       /include *libl/qmodsrc,#fmtphnPR
004600180620
005400180620
005500180620      *-------------------------------------------------------------------------
005600180620      *
005700180620      * Mainline Program
005800180620      *
005900180620      *-------------------------------------------------------------------------
006000180620
006100220829       pgmname = proc_name;
006101220829       btnExit = '0';
006102220829
006200220829       Dow btnExit = '0';
006900220829        ClearS1();
006901220829        LoadS1();
007000220829        DisplyS1();
007200161109
009000220829        ReadChangedS1();
009400161109
009500161109       enddo;
009600161109
009700161109       *inlr = *on;
009800161109
009900180620
010000180620
010100161109       // ----------------------------------------------------------------
010200180620       dcl-proc CLEARS1;
010300161109
010400180620          //-------------------------
010500180620          //
010600180620          // Clear the Subfile
010700180620          //
010800180620          //-------------------------
010900180620
011000161110          ClrSfl = *on;
011100170110          Write CtlSfl;
011200180620          ClrSfl = *off;
011300180620          rrn = 0;
011400161109
011500180620       End-Proc;
011600161109       // ----------------------------------------------------------------
011700180620       Dcl-Proc LoadS1;
011800170110
011900180620
012000220829          //dcl-s wSearch Char(20);
012100220829          //wSearch = CleanText( uCase(s1Search) );
012200180620
012300180620          Setll *loval Agenl1;
012301220829          read Agenl1;
012400220829          Dow not %eof;
012500161109
013000161109
013100180620             s1Code = agCode;
013200180620             s1Name = agNam1;
013300220829             //s1Clean = CleanText( uCase(agNam1) );
013400220829             s1Tmdt = d'0001-01-01';
013500180620             if agTmdt > 0;
013600220829                s1TmDt = %date(agTmdt:*iso);
013700180620             EndIf;
013900170602
014400180620                   rrn = rrn + 1;
014500180620                   write LstSfl;
017500180620
017501220829          read Agenl1;
018000180620          enddo;
018100161109
018200180620       End-Proc;
018300161109
018400161109       // ----------------------------------------------------------------
018500180620       Dcl-Proc DisplyS1;
018600161109
018700161110          DspSfl = *on  ;
018800180620          exfmt CtlSfl;
018900180620          DspSfl = *off;
019000161109
019100180620       End-Proc;
019200180620
019300161109       // ----------------------------------------------------------------
019400180620       Dcl-Proc ReadChangedS1;
019500161109
019600180620          Dou *in95 = *ON;
019700161109             READC LstSfl;
019800161109             *in95 = %EOF;
019900161109
020000180620             If *in95 = *OFF;
020100161109
020200170124
020300170601                //?Edit Job Record
020400220829                if btnSelect = 'Y';
020401220829                 inAgency = s1Code;
020402220829                 btnExit = '1';
020800180620                endIf;
020900170124
021500180620             endIf;
021600161109
021700180620          enddo;
021800180620
021900180620       End-Proc;
022000161111
022100180620
