000100160513      *===========================================================================
000200160512     H option(*noDebugIo)
000300160513      *===========================================================================
000400200803      * AMWINSCOI - Compliance Individual
000401190304      *===========================================================================
000600180313      * Date        Int   Description
000700190304      * ----------  ---   --------------------------------------------------------
000800200803      * 08/03/2020  jt    Original creation
000900160513      *===========================================================================
001000160512
004302200803     fmember    if   e           k disk    rename(membr:FImainFile)
004303200803     f                                     extfile('F.MEMBER')
004304200801
004305200803     faccmstp   if   e           k disk    rename(accmstr:GAmainFile)
004306200801
004307200803     fparticipl2if   e           k disk    rename(participr:SFmainFile)
004308200803
005202200803     famwinscomiif a e           k disk    rename(agbsgr:outFile)
005203200803
005204200803      *===========================================================================
005400181030      *   opcode to convert yyyymmdd to mmddyyyy
005500181030      *   xxx = %editc( %dec(%char(%date(numericdate:*iso):*mdy0):8:0):'X');
005501190304      *===========================================================================
005700061017
005701200803     d type            s              2
008501190429
009004190304      //===================================================================
009200160511      // mainline
009300160511      //===================================================================
009400150820
009500160511       exsr init;
009600160511       exsr main;
009700160511       exsr exit;
009800160511
009801200803      //===================================================================
009802200803      // main
009803200803      //===================================================================
009804200803
009805200803       begsr main;
009806200803
009807200803        type = 'FI';
009808200803        exsr main2;
009809200803
009810200803        type = 'SF';
009811200803        exsr main2;
009812200803
009813200803        type = 'GA';
009814200803        exsr main2;
009815200803
009816200803       endsr;
009817200803
009900181031      //===================================================================
010000200803      // main 2
010100181031      //===================================================================
010200181031
010300200803       begsr main2;
010301190514
010302200803        if type = 'FI';
010303200803         setll *loval FImainFile;
010304200803         read FImainFile;
010305200803         dow not %eof;
010306190514
010307200803          exsr process;
010314190514
010315200803         read FImainFile;
010318200803         enddo;
010400200803        endif;
010401200803
010402200803        if type = 'SF';
010403200803         setll *loval SFmainFile;
010404200803         read SFmainFile;
010405200803         dow not %eof;
010406200803
010407200803          exsr process;
010408200803
010409200803         read SFmainFile;
010410200803         enddo;
010411200803        endif;
010412200803
010413200803        if type = 'GA';
010414200803         setll *loval GAmainFile;
010415200803         read GAmainFile;
010416200803         dow not %eof;
010417200803
010418200803          exsr process;
010419200803
010420200803         read GAmainFile;
010421200803         enddo;
010422200803        endif;
010423200803
012800181031       endsr;
012900181031
012901200801      //===================================================================
012902200801      // process
012903200801      //===================================================================
012904200801
012905200801       begsr process;
012906200801
012911200803        if type  = 'FI';
012912200803
012914200803         if termdt > %dec(%date) or termdt = 0;
012915200803
012917200803          clear outfile;
012918200803
012919200803          daccttype = 'GBSIND';
012920200803          dacct# = %editc(mbssno:'X');
012921200803
012922200803          dname = %trim(mlname) + ', ' + %trim(mfname);
012923200803          if mmi > ' ';
012924200803           dname = %trim(mlname) + ' ' + %trim(mmi) + '., ' + %trim(mfname);
012925200803          endif;
012926200803
012927200803          dadd1 = addr1;
012928200803          dadd2 = addr2;
012929200803          dcityd = city;
012930200803          dstated = state;
012931200803
012932200803          if zip > 0;
012933200803           dzipd = %editc(zip:'X');
012934200803          endif;
012935200803
012936200803          dcountry = 'US';
012937200803
012938200803          monitor;
012939200803           ddob = %editc( %dec(%char(%date(birth:*iso):*usa0):8:0):'X');
012940200803          on-error;
012941200803           ddob = ' ';
012942200803          endmon;
012943200803
012944200803          dsex = sex;
012945200803          dssn = %editc(mbssno:'X');
012946200803
012947200803          if %subst(fill66:66:1) <> 'Y';
012948200803           write outFile;
012949200803          endif;
012950200803
012953200801         endif;
012954200803
012955200803        endif;
012956200801
012957200803        if type  = 'SF';
012958200803
012959200803         if gptermdt = 99999999;
012960200803          gptermdt = 0;
012961200803         endif;
012962200803
012963200803         if gptermdt > %dec(%date) or gptermdt = 0;
012964200803
012965200803          clear outfile;
012966200803
012967200803          daccttype = 'GBSIND';
012968200803          dacct# = gppartic;
012969200803
012970200803          dname = %trim(gplast) + ', ' + %trim(gpfirst);
012971200803          if gpmi > ' ';
012972200803           dname = %trim(gplast) + ' ' + %trim(gpmi) + '., ' + %trim(gpfirst);
012973200803          endif;
012974200803
012975200803          dadd1 = gpaddr1;
012976200803          dadd2 = gpaddr2;
012977200803          dcityd = gpcity;
012978200803          dstated = gpstate;
012979200803          dzipd = gpzip;
012980200803          dcountry = 'US';
012981200803
012982200803          monitor;
012983200803           ddob = %editc( %dec(%char(%date(gpdob:*iso):*usa0):8:0):'X');
012984200803          on-error;
012985200803           ddob = ' ';
012986200803          endmon;
012987200803
012988200803          dsex = gpsex;
012989200803          dssn = gpssn;
012990200803
012991200803          if %subst(dname:1:5) <> 'TEST,';
012992200803           write outFile;
012993200803          endif;
012994200803
012995200803         endif;
012996200803
012997200803        endif;
012998200803
012999200803        if type  = 'GA';
013000200803
013001200803         if adimd = 'Y';
013002200803
013003200803          if adtrdt > %date() or adtrdt = d'0001-01-01';
013004200803
013005200803           clear outfile;
013006200803
013007200803           daccttype = 'GBSIND';
013008200803           dacct# = adacct;
013009200803           dname = adname;
013010200803           dadd1 = adadd1;
013011200803           dadd2 = adadd2;
013012200803           dcityd = adcity;
013013200803           dstated = adstat;
013014200803           dzipd = adzip;
013015200803           dcountry = 'US';
013016200803
013017200803           monitor;
013018200803            //ddob = %editc( %dec(%char(addob):8:0):'X');
013019200803            ddob = %char(addob : *usa0);
013020200803           on-error;
013021200803            ddob = ' ';
013022200803           endmon;
013023200803
013024200803           dsex = ' ';
013025200803           dssn = ' ';
013026200803
013027200803           if %subst(dname:1:5) <> 'TEST,';
013028200803            write outFile;
013029200803           endif;
013030200803
013031200803          endif;
013032200803
013033200803         endif;
013034200803
013035200803        endif;
013036200803
013037200801       endsr;
013038200801
077100160511      //===================================================================
077200160511      // exit
077300160511      //===================================================================
077400160511
077500160511       begsr exit;
077600160511
077700160511        *inlr = '1';
077800160511        return;
077900160511
078000160511       endsr;
078100160511
078200160511      //===================================================================
078300160511      // init
078400160511      //===================================================================
078500160520
078600160511       begsr init;
078601200801
079800160511       endsr;
079900010412
079901200801      //===================================================================
