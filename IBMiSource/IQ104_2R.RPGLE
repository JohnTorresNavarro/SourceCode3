000100041006      *  ***************************************************************
000200041006      * iq104_2R - SALESMAN MASTER MAINTENANCE - ADDITIONAL INFO
000300041006      *   WRITTEN by Kimberly Johnson 4/2004
000400041006      *
000500041006      *  Description: display additional maintanence screen
000600041006
000700041006      *  FIELDS BEGINNING WITH W_ ARE DISPLAY FIELDS
000800041006      *  FIELDS beginning with S2 are SMAN2 fields
000900041006   X***X
001000041006   X***X 09/24/04 SSK Cleaned up code and made Grouper primary key.
001100041006     *** CLONED TO FM104_2R AS INQUIRY
001200041006   X***X
001300041006   X***X
001400041006      *  ***************************************************************
001500041006     Fiq104_2D  CF   E             WORKSTN PREFIX(W_) INFDS(WSDS)
001600041006     FSMAN2L    if   E           K DISK
001700041006     FAACODE    IF   E           K DISK
001800041006     FBRKREP    IF   E           K DISK
001900041006     FSTATECD   IF   E           K DISK
002000041006     FVENDACCTL1IF   E           K DISK
002100041006   X***X
002200041006     d @step           s              5a
002300041006     d*valid_s1********s*******        n
002400041006     d*valid_s2********s*******        n
002500041006     d*valid_s3********s*******        n
002600041006     d no              s               n   INZ(*OFF)
002700041006     d yes             s               n   INZ(*ON)
002800041006    ***
002900041006     D WSDS            DS
003000041006     D  FKEY                 369    369A
003100041006    ***
003200041006     D  F1             C                   CONST(X'31')
003300041006     D  F2             C                   CONST(X'32')
003400041006     D  F3             C                   CONST(X'33')
003500041006     D  F4             C                   CONST(X'34')
003600041006     D  F5             C                   CONST(X'35')
003700041006     D  F6             C                   CONST(X'36')
003800041006     D  F7             C                   CONST(X'37')
003900041006     D  F8             C                   CONST(X'38')
004000041006     D  F9             C                   CONST(X'39')
004100041006     D  F10            C                   CONST(X'3A')
004200041006     D  F11            C                   CONST(X'3B')
004300041006     D  F12            C                   CONST(X'3C')
004400041006     D  F13            C                   CONST(X'B1')
004500041006     D  F14            C                   CONST(X'B2')
004600041006     D  F15            C                   CONST(X'B3')
004700041006     D  F16            C                   CONST(X'B4')
004800041006     D  F17            C                   CONST(X'B5')
004900041006     D  F18            C                   CONST(X'B6')
005000041006     D  F19            C                   CONST(X'B7')
005100041006     D  F20            C                   CONST(X'B8')
005200041006     D  F21            C                   CONST(X'B9')
005300041006     D  F22            C                   CONST(X'BA')
005400041006     D  F23            C                   CONST(X'BB')
005500041006     D  F24            C                   CONST(X'BC')
005600041006    ***
005700041006     D ISO_DATE        S               D   DATFMT(*ISO)                         DATE VARIABLE *ISO
005800041006     D USA_DATE        S               D   DATFMT(*USA)                         DATE VARIABLE *USA
005900041006     d                 ds
006000041006     d parms@in                1     51a
006100041006     d  @grpr                  1      5a
006200041006     d  SCODE                  6      8a
006300041006     d  SNAME                  9     43a
006400041006     d  STERM                 44     51a
006500041006    ***
006600041006     **************************
006700041105    *D                 DS
006800041105    *D TIMEDATE_DS                   12  0 INZ(*ZEROS)
006900041105    *D  TIME_DS                       6  0 OVERLAY(TIMEDATE_DS)
007000041105    *D  DATE_DS                       6  0 OVERLAY(TIMEDATE_DS:7)
007100041006    ***************************
007200041006     D*@TIMESTAMP******DS******
007300041006     D**#TSCYMD****************1      8S 0
007400041006     D**#TSTIME****************9     14S 0
007500041006     D**@TSJOB****************15     24
007600041006     D**@TSUSER***************25     34
007700041006     D**#TSNBR****************35     40S 0
007800041006     D*@TS40***********S*******      40A
007900041006     D*DS@SM*********E*DS******            EXTNAME(SMAN2)
008000041006    ***
008100041006     D                 DS
008200041006     D COMPANY                       50a
008300041006     D W_CONAME                1     40a
008400041006   X***X
008500041006    ***
008600041006     c                   dou       @step = 'LEAVE'
008700041006     c     @step         caseq     'PREP1'       $prep1
008800041006     c     @step         caseq     'STEP1'       $step1
008900041006     c     @step         caseq     'STEP2'       $step2
009000041006     c     @step         caseq     'STEP3'       $step3
009100041006     c                   endcs
009200041006     c                   enddo
009300041006    ***
009400041006     C                   EVAL      *INLR = *ON
009500041006   S***S
009600041006     C     *INZSR        BEGSR                                                  INITIAL SETUP
009700041006    ***
009800041006     c                   clear                   scrn1
009900041006     c                   clear                   scrn2
010000041006     c                   clear                   scrn3
010100041006    ***
010200041006     C     *ENTRY        PLIST
010300041006     C                   PARM                    parmz            51
010400041006     C                   movel     parmz         parms@in
010500041006    ***
010600041006    *C     SMAN2KEY      KLIST
010700041006    *C                   KFLD                    @grpr
010800041006    ***
010900041006     C     LUMKEY        KLIST
011000041006     C                   KFLD                    W_LUMID5
011100041006     C                   KFLD                    W_LUMID4
011200041006    ***
011300041006     C     *DTAARA       DEFINE                  COMPANY
011400041006     C                   IN        COMPANY
011500041006    ***
011600041006     C                   EVAL      @step = 'PREP1'
011700041006    ***
011800041006     C                   TIME                    TIMEDATE_DS
011900041006     C     *MDY          MOVE      DATE_DS       USA_DATE
012000041006     C     *MDY          MOVE      DATE_DS       ISO_DATE
012100041006    ***
012200041006     C                   ENDSR
012300041006   S***S
012400041006     C     $prep1        BEGSR
012500041006    ***
012600041006     C                   MOVE      @grpr         W_grpcd
012700041006     C                   EVAL      W_ISCODE = SCODE
012800041006     C                   EVAL      W_ISNAME = SNAME
012900041006    ***
013000041006     c     @grpr         chain     sman2r
013100041006     c                   if        not %found(SMAN2L)
013200041006     c                   exfmt     NO_SMAN2
013300041006     C                   EVAL      @step = 'LEAVE'
013400041006     C                   LEAVESR
013500041006     c                   endif
013600041006    ***
013700041006     c                   exsr      $fmt_scn1
013800041006    ***
013900041006     C                   EVAL      @step = 'STEP1'
014000041006    ***
014100041006     C                   ENDSR
014200041006   S***S
014300041006     c     $fmt_scn1     begsr
014400041006    ***
014500041006     C                   EVAL      W_BRPHXT  = SBRPHXT
014600041006     C                   EVAL      W_BRADPH = SBRADPH
014700041006     C                   EVAL      W_BRFAX = SBRFAX
014800041006     C                   EVAL      W_ASNAM = SASNAM
014900041006     C                   EVAL      W_ASPHN = SASPHN
015000041006     C                   EVAL      W_ASFAX = SASFAX
015100041006     C                   EVAL      W_ASEML = SASEML
015200041006    ***
015300041006     C                   EVAL      W_BRBADD1 = SBRBADD1
015400041006     C                   EVAL      W_BRBADD2 = SBRBADD2
015500041006     C                   EVAL      W_BRBCTY = SBRBCTY
015600041006     C                   EVAL      W_BRBST = SBRBST
015700041006     C                   EVAL      W_BRBZIP5 = SBRBZIP5
015800041006     C                   EVAL      W_BRBZIP4 = SBRBZIP4
015900041006    ***
016000041006     C                   EVAL      W_BRHADD1 = SBRHADD1
016100041006     C                   EVAL      W_BRHADD2 = SBRHADD2
016200041006     C                   EVAL      W_BRHCTY = SBRHCTY
016300041006     C                   EVAL      W_BRHST = SBRHST
016400041006     C                   EVAL      W_BRHZIP5 = SBRHZIP5
016500041006     C                   EVAL      W_BRHZIP4 = SBRHZIP4
016600041006    ***
016700041006     C                   EVAL      W_BREML = SBREML
016800041006     C                   EVAL      W_BRNOTE  = SBRNOTE
016900041006     C                   EVAL      W_BRWEB  = SBRWEB
017000041006    ***
017100041006    3C                   IF        SDOB <> *ZEROS
017200041006     C                   MOVE      SDOB          ISO_DATE
017300041006     C                   MOVE      ISO_DATE      USA_DATE
017400041006     C                   MOVE      USA_DATE      W_DOB
017500041006    3C                   ENDIF
017600041006    ***
017700041006     C                   EVAL      W_LUMID5 = SLUMID5
017800041006     C                   EVAL      W_LUMID4 = SLUMID4
017900041006     C                   EVAL      W_GBSAG = SGBSAG
018000041006     C                   EVAL      W_GBSAC = SGBSAC
018100041006     C                   EVAL      W_AAID = SAAID
018200110801     C*                  EVAL      W_BRREP = SBRREP
018300041006     C                   EVAL      W_NOEML = SNOEML
018400041006     C                   EVAL      W_NOFAX = SNOFAX
018500041006    ***
018600041006     C                   EVAL      W_WEBID = SWEBID
018700041006     C                   EVAL      W_ASNAM = SASNAM
018800041006     C                   EVAL      W_ASPHN = SASPHN
018900041006     C                   EVAL      W_ASFAX = SASFAX
019000041006     C                   EVAL      W_ASEML = SASEML
019100041006     C                   EVAL      W_PRTCT = SPRTCT
019200041006     C                   EVAL      W_GRPCD = SGRPCD
019300041006    ***
019400041006     c                   eval      w_safax = safax
019500041006     c                   eval      w_saemail = saemail
019600041006    ***
019700041006     c*******************move**    @grpr         hfgrp
019800041006     C*******************MOVEL*    DS@SM         HBEFORE
019900041006    ***
020000041006     c                   endsr
020100041006   S***S
020200041006     C     $step1        BEGSR
020300041006    ***
020400041006     C                   EXFMT     SCRN1
020500041006     c                   move      *blanks       w_error_msg
020600041006    ***
020700041006     C                   IF        fkey = F3
020800041006     C                   EVAL      @step = 'LEAVE'
020900041006     C                   LEAVESR
021000041006     C                   END
021100041006    ***
021200041006      *  ALTERNATE CONTACT SCREEN                                           *****
021300041006     C                   IF        fkey = F8
021400041006     C                   CALL      'WRKBAC2CL'
021500041006     C                   PARM                    @grpr
021600041006     C                   LEAVESR
021700041006     C                   endif
021800041006    ***
021900041006     c*******************exsr**    $validate1
022000041006    ***************************
022100041006     c*******************if****    valid_s1 = yes
022200041006     c*******************exsr**    $fmt_rec
022300041006     c*******************update    sman2r
022400041006     c*******************exsr**    $prep1
022500041006     C                   EVAL      @step = 'STEP2'
022600041006     c*******************endif*
022700041006    ***
022800041006     C                   ENDSR
022900041006   S***S
023000041006     C*****$validate1****BEGSR*
023100041006    ***************************
023200041006     c*******************eval**    valid_s1 = no
023300041006     c*******************exsr**    $rst_ndc
023400041006    ***************************
023500041006     ***DOB********************
023600041006     C*******************IF****    W_DOB <> *ZEROS
023700041006     C******USA**********TEST(DE)                W_DOB
023800041006    1C*******************IF****    %ERROR
023900041006     C*******************EVAL**    W_ERROR_MSG = 'INVALID DATE'
024000041006     C*******************EVAL**    *in63 = *ON
024100041006     C*******************LEAVESR
024200041006     C*******************endif*
024300041006     C*******************ENDIF*
024400041006    ***************************
024500041006     ***LOCATION*ADDRESS*(BROKER)
024600041006     C*******************IF****    W_BRBADD1 <> *BLANKS or W_BRBCTY <> *BLANKS
024700041006    1C*************************    or W_BRBST <> *BLANKS or W_BRBZIP5 <> 0
024800041006    ***************************
024900041006    1C*******************IF****    W_BRBADD1 = *BLANKS
025000041006     C*******************EVAL**    W_ERROR_MSG = 'MUST ENTER ADDRESS'
025100041006     C*******************EVAL**    *in69 = *on
025200041006     C*******************LEAVESR
025300041006     C*******************ENDIF*
025400041006    ***************************
025500041006    1C*******************IF****    W_BRBCTY = *BLANKS
025600041006     C*******************EVAL**    W_ERROR_MSG = 'MUST ENTER CITY   '
025700041006     C*******************EVAL**    *in65 = *on
025800041006     C*******************LEAVESR
025900041006     C*******************ENDIF*
026000041006    ***************************
026100041006    1C*******************IF****    W_BRBST = *BLANKS
026200041006     C*******************EVAL**    W_ERROR_MSG = 'MUST ENTER STATE  '
026300041006     C*******************EVAL**    *in50 = *on
026400041006     C*******************LEAVESR
026500041006     C*******************ENDIF*
026600041006    ***************************
026700041006    1C*******************IF****    W_BRBZIP5  = *ZEROS
026800041006     C*******************EVAL**    W_ERROR_MSG = 'MUST ENTER ZIP CODE'
026900041006     C*******************EVAL**    *in67 = *on
027000041006     C*******************LEAVESR
027100041006     C*******************ENDIF*
027200041006    ***************************
027300041006     C*******************ENDIF*
027400041006    ***************************
027500041006     ***HOME*ADDRESS*(BROKER)**
027600041006     C*******************IF****    W_BRHADD1 <> *BLANKS or W_BRHCTY <> *BLANKS
027700041006    1C*************************    or W_BRHST <> *BLANKS or W_BRHZIP5 <> *ZEROS
027800041006    ***************************
027900041006    1C*******************IF****    W_BRHADD1 = *BLANKS
028000041006     C*******************EVAL**    W_ERROR_MSG = 'MUST ENTER ADDRESS'
028100041006     C*******************EVAL**    *in79 = *ON
028200041006     C*******************LEAVESR
028300041006     C*******************END***
028400041006    ***************************
028500041006    1C*******************IF****    W_BRHCTY = *BLANKS
028600041006     C*******************EVAL**    W_ERROR_MSG = 'MUST ENTER CITY'
028700041006     C*******************EVAL**    *in75 = *on
028800041006     C*******************LEAVESR
028900041006     C*******************END***
029000041006    ***************************
029100041006    1C*******************IF****    W_BRHST = *BLANKS
029200041006     C*******************EVAL**    W_ERROR_MSG = 'MUST ENTER STATE'
029300041006     C*******************EVAL**    *in40 = *on
029400041006     C*******************LEAVESR
029500041006     C*******************END***
029600041006    ***************************
029700041006    1C*******************IF****    W_BRHZIP5  = *ZEROS
029800041006     C*******************EVAL**    W_ERROR_MSG = 'MUST ENTER ZIP    '
029900041006     C*******************EVAL**    *in77 = *ON
030000041006     C*******************LEAVESR
030100041006     C*******************END***
030200041006    ***************************
030300041006     C*******************endif*
030400041006    ***************************
030500041006     C*******************IF****    W_BRBST <> *BLANKS
030600041006    ***************************
030700041006     C*****W_BRBST*******chain*    STATEF
030800041006     C*******************IF****    NOT %found(STATECD)
030900041006     C*******************EVAL**    W_ERROR_MSG = 'INVALID STATE'
031000041006     C*******************EVAL**    *in66 = *on
031100041006     C*******************LEAVESR
031200041006     C*******************END***
031300041006    ***************************
031400041006     C*******************ENDIF*
031500041006    ***************************
031600041006     C*******************IF****    W_BRHST <> *BLANKS
031700041006    ***************************
031800041006     C*****W_BRHST*******chain*    STATEF
031900041006     C*******************IF****    NOT %found(STATECD)
032000041006     C*******************EVAL**    W_ERROR_MSG = 'INVALID STATE'
032100041006     C*******************EVAL**    *in76 = *on
032200041006     C*******************LEAVESR
032300041006     C*******************END***
032400041006    ***************************
032500041006     C*******************ENDIF*
032600041006    ***************************
032700041006     c*******************eval**    valid_s1 = yes
032800041006    ***************************
032900041006     C*******************ENDSR*
033000041006   S***S
033100041006     C     $rst_ndc      BEGSR
033200041006    ***
033300041006     c     1             do        45            n                 3 0
033400041006     c     n             add       39            i                 2 0
033500041006     c                   eval      *in(i) = *OFF
033600041006     c                   enddo
033700041006    ***
033800041006     C                   ENDSR
033900041006   S***S
034000041006     c*****$fmt_rec******begsr*
034100041006    ***************************
034200041006     C*******************EVAL**    SBRPHXT   = W_BRPHXT
034300041006     C*******************EVAL**    SBRADPH   = W_BRADPH
034400041006     C*******************EVAL**    SBRFAX    = W_BRFAX
034500041006     C*******************EVAL**    SASNAM    = W_ASNAM
034600041006     C*******************EVAL**    SASPHN    = W_ASPHN
034700041006     C*******************EVAL**    SASFAX    = W_ASFAX
034800041006     C*******************EVAL**    SASEML    = W_ASEML
034900041006    ***************************
035000041006     C*******************EVAL**    SBRBADD1  = W_BRBADD1
035100041006     C*******************EVAL**    SBRBADD2  = W_BRBADD2
035200041006     C*******************EVAL**    SBRBCTY   = W_BRBCTY
035300041006     C*******************EVAL**    SBRBST    = W_BRBST
035400041006     C*******************EVAL**    SBRBZIP5  = W_BRBZIP5
035500041006     C*******************EVAL**    SBRBZIP4  = W_BRBZIP4
035600041006    ***************************
035700041006     C*******************EVAL**    SBRHADD1  = W_BRHADD1
035800041006     C*******************EVAL**    SBRHADD2  = W_BRHADD2
035900041006     C*******************EVAL**    SBRHCTY   = W_BRHCTY
036000041006     C*******************EVAL**    SBRHST    = W_BRHST
036100041006     C*******************EVAL**    SBRHZIP5  = W_BRHZIP5
036200041006     C*******************EVAL**    SBRHZIP4  = W_BRHZIP4
036300041006    ***************************
036400041006     C*******************EVAL**    SBREML    = W_BREML
036500041006     C*******************EVAL**    SBRNOTE   = W_BRNOTE
036600041006     C*******************EVAL**    SBRWEB    = W_BRWEB
036700041006    ***************************
036800041006    3C*******************IF****    w_DOB <> *ZEROS
036900041006     c*******************move**    w_dob         usa_date
037000041006     C*******************MOVE**    usa_DATE      iso_DATE
037100041006     C*******************MOVE**    iso_DATE      sDOB
037200041006    3C*******************ENDIF*
037300041006    ***************************
037400041006     C*******************EVAL**    SLUMID5   = W_LUMID5
037500041006     C*******************EVAL**    SLUMID4   = W_LUMID4
037600041006     C*******************EVAL**    SGBSAG    = W_GBSAG
037700041006     C*******************EVAL**    SGBSAC    = W_GBSAC
037800041006     C*******************EVAL**    SAAID     = W_AAID
037900041006     C*******************EVAL**    SBRREP    = W_BRREP
038000041006     C*******************EVAL**    SNOEML    = W_NOEML
038100041006     C*******************EVAL**    SNOFAX    = W_NOFAX
038200041006    ***************************
038300041006     C*******************EVAL**    SWEBID    = W_WEBID
038400041006     C*******************EVAL**    SASNAM    = W_ASNAM
038500041006     C*******************EVAL**    SASPHN    = W_ASPHN
038600041006     C*******************EVAL**    SASFAX    = W_ASFAX
038700041006     C*******************EVAL**    SASEML    = W_ASEML
038800041006     C*******************EVAL**    SPRTCT    = W_PRTCT
038900041006    ***************************
039000041006     C*******************EVAL**    safax     = w_safax
039100041006     C*******************EVAL**    saemail   = w_saemail
039200041006    ***************************
039300041006     ********************MOVEL     DS@SM         Hafter
039400041006    *********************MOVEL     DS@SM         Hafter
039500041006     C*******************CLEAR     DS@SM         @TIMESTAMP
039600041006     C*******************MOVEL     *BLANKS       @TS40r
039700041006    *********************MOVEL     DS@SM         Hafter
039800041006     C*******************CALLL     'TIMESTMP'    Hafter
039900041006     C*******************PARML     DS@SM         @TS40r
040000041006    *********************MOVEL     DS@SM         Hafter
040100041006     C*******************MOVEL     @TS40         @TIMESTAMP
040200041006     C*******************MOVEL     @TSUSER       HUSERID
040300041006     C*******************MOVEL     #TSCYMD       HDATEr
040400041006     C*******************MOVEL     #TSTIME       HTIMEr
040500041006     C*******************MOVEL     @TSJOB        HJOBer
040600041006     C*******************MOVEL     #TSNBR        HNUMBER
040700041006    *********************MOVEL     DS@SM         Hafter
040800041006     c*******************ifVEL     hbefore <> hafterter
040900041006     c*******************write     rsm2hist      Hafter
041000041006     c*******************endif     DS@SM         Hafter
041100041006    ***************************
041200041006     c*******************endsr*
041300041006   S***S
041400041006     C     $step2        BEGSR
041500041006    ***
041600041006     C                   EXFMT     SCRN3
041700041006     c                   move      *blanks       w_error_msg
041800041006    ***
041900041006     C                   IF        fkey = F1
042000041006     C                   EVAL      @step = 'STEP1'
042100041006     C                   LEAVESR
042200041006     C                   END
042300041006    ***
042400041006     C                   IF        fkey = F3
042500041006     C                   EVAL      @step = 'LEAVE'
042600041006     C                   LEAVESR
042700041006     C                   END
042800041006    ***
042900041006     C*******************IF****    fkey = F4
043000041006     C*******************exsr**    $f4
043100041006     C*******************LEAVESR
043200041006     C*******************END***
043300041006    ***************************
043400041006      *  ALTERNATE CONTACT SCREEN                                           *****
043500041006     C                   IF        fkey = F8
043600041006     C                   CALL      'WRKBAC2CL'
043700041006     C                   PARM                    @grpr
043800041006     C                   LEAVESR
043900041006     C                   endif
044000041006    ***
044100041006     c*******************exsr**    $validate3
044200041006    ***************************
044300041006     c*******************if****    valid_s3 = yes
044400041006     c*******************exsr**    $fmt_rec
044500041006     ********************update    sman2r
044600041006     c*******************exsr**    $prep1
044700041006     C                   EVAL      @step = 'STEP3'
044800041006     c*******************endif*
044900041006    ***
045000041006     C                   ENDSR
045100041006   S***S
045200041006     C*****$f4***********BEGSR*
045300041006    ***************************
045400041006     C*******************select
045500041006     C*************************
045600041006     C*******************when**    w_Wsfld = 'AAID' or w_wsfld = 'W_AAID'
045700041006     c*******************eval**    @3 = *blanks
045800041006    ?C*******************CALL**    'SLCAAD'                                     CALL SELECT PROGRAM
045900041006    ?C*******************PARM**                  @3                3            REQUEST
046000041006    ?C*******************if****    @3 <> *blanks                                RETURN CODE
046100041006    ?C*******************eval**    w_aaid = @3                                  PROGRAM
046200041006    ?C*******************endif*                                                 RECORD DS
046300041006     C*************************
046400041006     C*******************when**    W_wsfld = 'BRREP' or w_wsfld = 'W_BRREP'
046500041006    ?C*******************CALL**    'SLCBRL'                                     CALL SELECT PROGRAM
046600041006    ?C*******************PARM**                  WWRQS                          REQUEST
046700041006    ?C*******************PARM**                  WWRTN                          RETURN CODE
046800041006    ?C*******************PARM**                  WUPGM                          PROGRAM
046900041006    ?C*******************PARM**                  @43              43            RECORD DS
047000041006     C*******************IF****    WWRTN = *BLANKS
047100041006     C*******************movel*    @43           @5                5
047200041006     C*******************move**    @5            w_brrep
047300041006    ?C*******************endif*                                                 RECORD DS
047400041006     C*************************
047500041006     C*******************when**    w_wsfld = 'SAEMAIL' or w_wsfld = 'W_SAEMAIL'
047600041006     c*******************movel(p)  @grpr         wwrtn
047700041006    ?C*******************CALL**    'SLCBAC'                                     CALL SELECT PROGRAM
047800041006    ?C*******************PARM**                  WWRQS             8            REQUEST
047900041006    ?C*******************PARM**                  WWRTN             8            RETURN CODE
048000041006    ?C*******************PARM**                  WUPGM            10            PROGRAM
048100041006    ?C*******************PARM**                  @118            118            RECORD DS
048200041006     C*******************IF****    WWRTN = *BLANKS
048300041006     C*******************EVAL**    @5 = %subst(@118:6:5)
048400041006     C*******************move**    @5            w_saemail
048500041006     C*******************ENDIF*
048600041006     C*************************
048700041006     C*******************when**    w_wsfld = 'SAFAX' or w_wsfld = 'W_SAFAX'
048800041006     c*******************movel(p)  @grpr         wwrtn
048900041006    ?C*******************CALL**    'SLCBAC'                                     CALL SELECT PROGRAM
049000041006    ?C*******************PARM**                  WWRQS             8            REQUEST
049100041006    ?C*******************PARM**                  WWRTN             8            RETURN CODE
049200041006    ?C*******************PARM**                  WUPGM            10            PROGRAM
049300041006    ?C*******************PARM**                  @118            118            RECORD DS
049400041006     C*******************IF****    WWRTN = *BLANKS
049500041006     C*******************EVAL**    @5 = %subst(@118:6:5)
049600041006     C*******************move**    @5            w_safax
049700041006     C*******************ENDIF*
049800041006     C*************************
049900041006     c*******************endsl*
050000041006    ***************************
050100041006     C*******************ENDSR*
050200041006   S***S***********************
050300041006     C*****$validate3****BEGSR*
050400041006    ***************************
050500041006     c*******************eval**    valid_s3 = no
050600041006     c*******************exsr**    $rst_ndc
050700041006    ***************************
050800041006    1C*******************IF****    W_GBSAG <> 'Y' AND W_GBSAG <> 'N'
050900041006     C*******************EVAL**    W_ERROR_MSG = 'MUST ENTER Y OR N'
051000041006     C*******************EVAL**    *in59 = *ON
051100041006     C*******************LEAVESR
051200041006     C*******************END***
051300041006    ***************************
051400041006    1C*******************IF****    W_GBSAC <> 'Y' AND W_GBSAC <> 'N'
051500041006     C*******************EVAL**    W_ERROR_MSG = 'MUST ENTER Y OR N'
051600041006     C*******************EVAL**    *in60 = *ON
051700041006     C*******************LEAVESR
051800041006     C*******************END***
051900041006    ***************************
052000041006    1C*******************IF****    W_NOEML <> 'Y' AND W_NOEML <> 'N'
052100041006     C*******************EVAL**    W_ERROR_MSG = 'MUST ENTER Y OR N'
052200041006     C*******************EVAL**    *in61 = *ON
052300041006     C*******************LEAVESR
052400041006     C*******************END***
052500041006    ***************************
052600041006    1C*******************IF****    W_NOFAX <> 'Y' AND W_NOFAX <> 'N'
052700041006     C*******************EVAL**    W_ERROR_MSG = 'MUST ENTER Y OR N'
052800041006     C*******************EVAL**    *in62 = *ON
052900041006     C*******************LEAVESR
053000041006     C*******************END***
053100041006    ***************************
053200041006     ****VALIDATE*DATA*IN*LUMID
053300041006     C*******************IF****    W_LUMID5 <> *BLANKS AND
053400041006     C*************************    W_LUMID4 <> *BLANKS
053500041006    ***************************
053600041006     C*****LUMKEY********CHAIN*    VENDACCTR
053700041006     C*******************IF****    NOT %FOUND(VENDACCTL1)
053800041006     C*******************EVAL**    W_ERROR_MSG = 'INVALID VENDOR ID'
053900041006     C*******************EVAL**    *in51 = *on
054000041006     C*******************LEAVESR
054100041006     C*******************ENDIF*
054200041006    ***************************
054300041006     C*******************ENDIF*
054400041006    ***************************
054500041006     ****VALIDATE*DATA*IN*AAID*
054600041006     C*******************IF****    W_AAID <> *BLANKS
054700041006    ***************************
054800041006     C*****W_AAID********CHAIN*    AACODR
054900041006     C*******************IF****    NOT %FOUND(AACODE)
055000041006     C*******************EVAL**    W_ERROR_MSG = 'INVALID AA CODE'
055100041006     C*******************EVAL**    *in53 = *ON
055200041006     C*******************LEAVESR
055300041006     C*******************ENDIF*
055400041006    ***************************
055500041006     C*******************ENDIF*
055600041006    ***************************
055700041006     C*****W_BRREP*******CHAIN*    BRKREPR
055800041006     C*******************IF****    NOT %FOUND(BRKREP)
055900041006     C*******************EVAL**    W_ERROR_MSG = 'INVALID BROKER REP CODE'
056000041006     C*******************EVAL**    *in54 = *ON
056100041006     C*******************LEAVESR
056200041006     C*******************ENDIF*
056300041006    ***************************
056400041006     c*******************eval**    valid_s3 = yes
056500041006    ***************************
056600041006     C*******************ENDSR*
056700041006   S***S
056800041006     C     $step3        BEGSR
056900041006    ***
057000041006     C                   EXFMT     SCRN2
057100041006     c                   move      *blanks       w_error_msg
057200041006    ***
057300041006     C                   IF        fkey = F1
057400041006     C                   EVAL      @step = 'STEP2'
057500041006     C                   LEAVESR
057600041006     C                   END
057700041006    ***
057800041006     C                   IF        fkey = F3
057900041006     C                   EVAL      @step = 'LEAVE'
058000041006     C                   LEAVESR
058100041006     C                   END
058200041006    ***
058300041006     c*******************exsr**    $validate2
058400041006    ***************************
058500041006     c*******************if****    valid_s2 = yes
058600041006     c*******************exsr**    $fmt_rec
058700041006     ********************update    sman2r
058800041006     C                   EVAL      @step = 'PREP1'
058900041105     c*******************endif
059000041006    ***
059100041006     C                   ENDSR
059200041006   S***S
059300041006     C*****$validate2****BEGSR*
059400041006    ***************************
059500041006     c*******************eval**    valid_s2 = no
059600041006     c*******************exsr**    $rst_ndc
059700041006    ***************************
059800041006     C*******************IF****    W_ASNAM = *BLANKS AND
059900041006     C*************************    (W_ASPHN <> *ZEROS OR
060000041006     C*************************    W_ASFAX <> *ZEROS OR
060100041006     C*************************    W_ASEML <> *BLANKS)
060200041006     C*******************EVAL**    W_ERROR_MSG = 'MUST ENTER NAME'
060300041006     C*******************EVAL**    *in55 = *ON
060400041006     C*******************LEAVESR
060500041006     C*******************END***
060600041006    ***************************
060700041006     c*******************eval**    valid_s2 = yes
060800041006    ***************************
060900041006     C*******************ENDSR*
061000041006   S***S
