000100220124        Ctl-opt option(*nodebugio:*srcstmt:*nounref)
000200220124                         DftActGrp(*no)
000300220124                         bnddir('GBSBIND' )   ;
000400220125      //_________________________________________________________________________
000500220125      //
000600220125      //  Description:  Prompt for required parm
000700220125      //
000800220125      //  (c)Copyright 1999 by Inovative Outsourcing, Inc.
000900220125      //
001000220125      //  History:
001100220125      //_________________________________________________________________________
001200220125       dcl-f CFSMNUD Workstn
001300220125         HANDLER('PROFOUNDUI(HANDLER)') ;
001400220125      //_________________________________________________________________________
001500000000     D WAF             S             40    DIM(30) CTDATA PERRCD(1)
001600000000     D WAD             S             80    DIM(6)
001700001018     D WTM             S             80    DIM(1) CTDATA PERRCD(1)
001800220125      //_________________________________________________________________________
001900220125      // Program status data structure
002000220125       dcl-ds pgmd
002100220125         ExtName('IOPGMD') PSDS;
002200220125         @pgmq *proc;
002300220125       end-ds;
002400220125      //
002500220125      // CURSOR LOCATION
002600980311     D                 DS
002700980311     D  WWCRSL                 1      2
002800980311     D  WWCRSN                 1      2B 0
002900220125      //_________________________________________________________________________
003000220125      // Process display panel
003100220125                       clear WWCNT;
003200220125                       Exsr PRPPNL;
003300220125
003400220125B001               DOW WWSTT <> 'END';
003500220125 001                   Exsr RCVMSG;
003600220125 001                   Exsr DSPPNL;
003700220125 001                   Exsr PRCFKY;
003800220125 001
003900220125 001              select;
004000220125 001              when   wwfnc = 'KEYS';
004100220125 001                     Exsr PRCDKY;
004200220125 001              when   wwfnc = 'ENTER';
004300220125 001                     Exsr PRCENT;
004400220125 001              when   *in03 = *on;
004500220125 001                     Exsr PRCOUT;
004600220125 001              endsl;
004700220125 001
004800220125E001              Enddo;
004900220125 001
005000220125                  *INLR  = *on;
005100220125      //___________________________________________________________________
005200220125       Begsr PRCOUT;
005300220125                        WWSTT = 'END';
005400220125       Endsr;
005500220125       //___________________________________________________________________
005600220125       // Prepare display panel
005700220125       //___________________________________________________________________
005800220125       Begsr PRPPNL;
005900220125         //
006000220125         // Initialize variables
006100220125
006200220125                         WWIN = *blanks;
006300220125                         WWOCD = *blanks;
006400220125                         WWSTT = *blanks;
006500220125                         WORTN = *blanks;
006600220125                         WWPNL = 1;
006700220125                         WWPNLN = 1;
006800220125                         WWFKS = 1;
006900220125                         WW    = 0;
007000220125                         WWDSP = 1;
007100220125
007200220125             Exsr BLDFKY;
007300220125
007400220125       Endsr;
007500220125       //___________________________________________________________________
007600220125       // Receive messages
007700220125       //___________________________________________________________________
007800220125       Begsr RCVMSG;
007900000000     C                   Movea     *IN           WWIN
008000000000     C                   Call      'PRCMSG2'
008100980223     C                   Parm      'RECEIVE '    WWRQS             8
008200000000     C                   Parm                    WWIN
008300000000     C                   Parm                    WWRTN             8
008400000000     C                   Movea     WWIN          *IN
008500220125       Endsr;
008600220125       //___________________________________________________________________
008700220125       // Display the display panel
008800220125       //___________________________________________________________________
008900220125       Begsr DSPPNL;
009000220125         //
009100220125         // Set OVERLAY based on last display file processed
009200220125
009300220125B001              IF WQPGMN <> WUPGM;
009400220125                     *IN35 = *OFF;
009500220125                     WUPGM = WQPGMN;
009600220125X001              Else;
009700220125                    *IN35 = *ON;
009800220125E001              Endif;
009900220125
010000220125         // Write message subfile
010100220125                 *IN30 = *ON;
010200220125
010300220125         //*                 Write     MSGCTL
010400220125                 Clear SELECT;
010500220125         //
010600220125         // Write display panels
010700220125
010800220125                  WWDSP = 1;
010900220125
011000220125B001             IF WWDSP = 1;
011100220125 001                Exfmt SCRN01;
011200220125E001             Endif;
011300220125
011400220125       Endsr;
011500220125       //___________________________________________________________________
011600220125       // Build function key information
011700220125       //___________________________________________________________________
011800220125       Begsr BLDFKY;
011900991108     C                   Movea     *IN           WWIN
012000991108     C                   Call      'PRCFKY2'
012100000000     C                   Parm      'BUILD   '    WWRQS
012200000000     C     WWFNC         Parm                    WWRTN
012300000000     C                   Parm                    WAD
012400991108     C                   Parm                    WWIN
012500000000     C                   Parm                    WAF
012600000000     C                   Parm                    WIFKY
012700220125      //
012800000000     C     WWFKS         Add       WWFKS         WW
012900000000     C                   Sub       1             WW
013000220125      //
013100220125       Endsr;
013200220125       //___________________________________________________________________
013300220125       // Process function keys
013400220125       //___________________________________________________________________
013500220125       Begsr PRCFKY;
013600991108     C                   Movea     *IN           WWIN
013700991108     C                   Call      'PRCFKY2'
013800000000     C                   Parm      'PROCESS '    WWRQS
013900000000     C     WWFNC         Parm                    WWRTN
014000000000     C                   Parm                    WAD
014100991108     C                   Parm                    WWIN
014200000000     C                   Parm                    WAF
014300000000     C                   Parm                    WIFKY
014400220125       Endsr;
014500220125       //___________________________________________________________________
014600220125       // Process KEYS function
014700220125       //___________________________________________________________________
014800220125       Begsr PRCDKY;
014900220125                         ww = 1;
015000220125B001                     DOU WWFKS = 1
015100220125 001                         OR WAD(WW) <> *BLANKS;
015200220125 001
015300220125                         WWFKS = WWFKS+1;
015400220125B002                     IF WWFKS > 3;
015500220125 002                     WWFKS = 1;
015600220125E002                     Endif;
015700220125 001
015800220125 001                     ww = WWFKS * 2;
015900220125 001                     ww = WW - 1;
016000220125 001
016100220125E001                     Enddo;
016200220125
016300220125       Endsr;
016400220125       //___________________________________________________________________
016500220125       // Process RETURN function
016600220125       //___________________________________________________________________
016700220125       Begsr PRCRTN;
016800220125                     WORTN = *blanks;
016900220125       Endsr;
017000220125       //___________________________________________________________________
017100220125       // Process ROLLUP function
017200220125       //___________________________________________________________________
017300220125       Begsr PRCRUP;
017400220125                         WWPNL = WWPNL + 1;
017500220125B001                    IF WWPNL > WWPNLN;
017600220125                         WWPNL = WWPNL - 1;
017700220125E001                    Endif;
017800220125       Endsr;
017900220125       //___________________________________________________________________
018000220125       // Process ROLLDOWN function
018100220125       //___________________________________________________________________
018200220125       Begsr PRCRDN;
018300220125                         WWPNL = WWPNL - 1;
018400220125B001                   IF WWPNL < 1;
018500220125                         WWPNL = WWPNL + 1;
018600220125E001                   Endif;
018700220125       Endsr;
018800220125       //___________________________________________________________________
018900220125       // Process ENTER function
019000220125       //___________________________________________________________________
019100220125       Begsr PRCENT;
019200220125
019300220125                         WWRTN = *blanks;
019400220125                         Exsr CHKDTA;
019500220125
019600220125B001                    IF WWRTN = *Blanks;
019700220125 001                    EXSR PRCRTN;
019800220125E001                    Endif;
019900220125
020000220125       Endsr;
020100220125       //___________________________________________________________________
020200220125       // Check data
020300220125       //___________________________________________________________________
020400220125       Begsr CHKDTA;
020500220125
020600220125                         WWRTN = *blanks;
020700980402     C                   Movea     *ALL'0'       *IN(60)
020800220125
020900220125      // Location must be selected.
021000220125                    If Select <> *blanks;
021100220124     C                   call      'CFSMNUCL2'
021200220124     C                   parm                    SELECT
021300220124     C                   parm                    MSG              60
021400220124     C                   parm                    RTN               1
021500220125                    endif;
021600220124
021700220125B001                If RTN      <>   *BLANKS;
021800220124 001 C                   Movel     WTM(1)        WWMSG
021900220125 001                Exsr SNDMSG;
022000220124 001 C                   Move      'ERROR   '    WWRTN
022100220125E001                Endif;
022200220125
022300220125         // WWCNT is for Enter Key control (x2)
022400220125         WWCNT = 0;
022500220125B001     IF WWCNT = *ZEROS
022600220125 001     AND WWRTN = *BLANKS;
022700980403 001 C                   Add       1             WWCNT
022800220124 001 C                   Move      'WARNING '    WWRTN
022900220125X001     Else;
023000980403 001 C                   Z-add     *ZEROS        WWCNT
023100220125E001     Endif;
023200220125
023300220125       Endsr;
023400220125       //___________________________________________________________________
023500220125       // Send message
023600220125       //___________________________________________________________________
023700220125       Begsr SNDMSG;
023800000000     C                   Call      'QSNDDTAQ'
023900000000     C                   Parm      'MSGDTAQ'     WWDTAQ           10
024000000000     C                   Parm      'QTEMP'       WWLIB            10
024100000000     C                   Parm      80            WWLNGQ            5 0
024200000000     C                   Parm                    WWMSG            80
024300220125       Endsr;
024400220125       //___________________________________________________________________
024500220125       // Parameter lists
024600220125       //___________________________________________________________________
024700220125       Begsr PLIST;
024800000000     C     *ENTRY        Plist
024900000000     C     WWTSK         Parm                    WIRQS             8
025000001018     C                   Parm                    WORTN            10
025100000000     C                   Parm                    WUPGM            10
025200220124     C                   Parm                    WIFKY            60
025300220124     C                   Parm                    CONAME           60
025400220125       Endsr;
025500220125       //___________________________________________________________________
025600220125       // Initialize routine
025700220125       //___________________________________________________________________
025800220125       Begsr *INZSR;
025900220124     C                   Movel     '*'           MSPGMQ            1
026000001018     C                   Movel     'PMTREQD '    WWFIL
026100000000     C                   Move      *BLANKS       WWFLK
026200000000     C                   Move      *BLANKS       WWTXT
026300220125       Endsr;
026400220125       //___________________________________________________________________
026500220125       // Define  routine
026600220125       //___________________________________________________________________
026700220125       Begsr DEFN;
026800220125         //
026900980311     C     *LIKE         Define    WIRQS         WWORQS
027000980311     C     *LIKE         Define    WWPNL         WWPNLO
027100980323     C     *LIKE         Define    WWPNL         WWDSP
027200220125      //
027300000000     C     *LIKE         Define    WIRQS         WWTSK
027400001018     C     *LIKE         Define    WIRQS         WWFNC
027500000000     C     *LIKE         Define    WIFKY         WWFKY
027600000000     C     *LIKE         Define    WIFKY         WWFKV
027700000000     C     *LIKE         Define    WIFKY         WWOPV
027800000000     C                   Move      WWIN          WWIN             99
027900000000     C                   Move      WWOCD         WWOCD             8
028000220124     C                   Move      WWSTT         WWSTT             3
028100220124     C                   Move      *blanks       REQPRM            1
028200000000     C                   Z-add     WWPNL         WWPNL             1 0
028300000000     C                   Z-add     WWPNLN        WWPNLN            1 0
028400000000     C                   Z-add     WWFKS         WWFKS             1 0
028500000000     C                   Z-add     WW            WW                3 0
028600000000     C                   Move      WWFIL         WWFIL            10
028700000000     C                   Move      WWFLK         WWFLK           128
028800000000     C                   Move      WWTXT         WWTXT            60
028900220125      //
029000980403     C     *LIKE         Define    WW            WWCNT
029100220125      //
029200220125       Endsr;
029300220125       //___________________________________________________________________
029400220125       // Program error handler
029500220125       //___________________________________________________________________
029600220125       Begsr *PSSR;
029700000000     C                   Call      'SNDRPGM'                            50
029800000000     C                   Parm                    WQPGMN
029900000000     C                   Parm                    WQSTSC
030000000000     C                   Parm                    WQRPGS
030100000000     C                   Parm                    WQMSG
030200220125       Endsr '*CANCL';
030300220125       //
030400991116**  WAF FUNCTION KEY TABLE - 30X40      |INDICATOR 2.0, ACTION8A, DESCR 30A    |
03050019020712CANCEL
03060098032425ROLLUP
03070098032426ROLLDOWN
030800980312** WTM
03090000101861This is a required parameter.
