000100180323      *=========================================================================
000200180323     h dftactgrp(*no) option(*noDebugIo) bnddir('GBSBIND')
000300180323      *=========================================================================
000400220519      * FM330PL  - PCP File Maintenance - Get SSN
000500180326      *========================================================================
000600180326      * Date         Int  Description
000700180326      * ---------    ---  -----------------------------------------------------
000800220519      * 05/19/2020   rlj  Original Creation
000900180326      *========================================================================
001000180628
001100220519     ffm330dx   cf   e             WorkStn Handler('PROFOUNDUI(HANDLER)')
001200200720
001300200720     fmember    if   e           k disk    extfile('F.MEMBER')
001400200720     f                                     rename(membr:memberFile)
001500180323
001600180323      //========================================================================
001700180323
001800180323     d psds           sds
001900180323     d proc_name         *proc
002000180323
002100200720
002200220519     d SSNout          s              9
002300200720
002400220519     d linkSSN         pr                  ExtPgm('INQ005R')
002500220519     d  SSNout                        9
002600200720
002700220519        //d cob420br        pi
002800220519        //d  option                        1
002900200720
003000180323      //========================================================================
003100180323      // mainline
003200180323      //========================================================================
003300180323
003400180323       exsr init;
003500180323       exsr main;
003600180323       exsr exit;
003700180323
003800180323      //========================================================================
003900180323      // main
004000180323      //========================================================================
004100180323
004200180323       begsr main;
004300180323
004400180323        dow btnExit = '0';
004500180323
004600180323         exfmt screen1;
004700180323
004800180323         exsr checkButton;
004900180323
005000180323        enddo;
005100180323
005200180323       endsr;
005300180323
005400180323      //========================================================================
005500180323      // checkButton
005600180323      //========================================================================
005700180323
005800180323       begsr checkButton;
005900180323
006000180323        if btnExit = '1';
006100180323         leavesr;
006200180323        endif;
006300180323
006400180323        if btnEnter = '1';
006500180323         exsr validCheck;
006600200720         btnEnter = '0';
006700180323        endif;
006800180323
006900180323       endsr;
007000180323
007100180323      //========================================================================
007200180323      // valid check
007300180323      //========================================================================
007400180323
007500180323       begsr validCheck;
007600180323
007700200720        errSSN = '0';
007800220519
007900220519        if SSNin = 0;
008000220519          errSSN = '1';
008100220519          leavesr;
008200220519        endif;
008300180323
008400220519        if SSNin > 0;
008500220519         chain SSNin memberFile;
008600200720
008700200720         if not %found;
008800200720           errSSN = '1';
008900200720          leavesr;
009000200720         endif;
009100180323
009200220519         SSNout = %editc(SSNin:'X');
009300220519         linkSSN(SSNout);
009400220519          SSNin = 0;
009500200825         leavesr;
009600200720        endif;
009700200720
009800180323       endsr;
009900180323
010000180323      //========================================================================
010100180323      // exit
010200180323      //========================================================================
010300180323
010400180323       begsr exit;
010500180323
010600180323        *inlr = '1';
010700180323        return;
010800180323
010900180323       endsr;
011000180323
011100180323      //========================================================================
011200180323      // init
011300180323      //========================================================================
011400180323
011500180323       begsr init;
011600180323
011700180323        btnEnter = '0';
011800180323        btnExit = '0';
011900180323        pgmname = proc_name;
012000200720        errSSN = '0';
012100200720
012200180323       endsr;
012300180323
012400180323      //========================================================================
