000100150924     H option(*noDebugIo)  bnddir('GBSBIND')  DftActGrp(*no)
000200150924    ? *-------------------------------------------------------------------------
000300150924    ? *
000400160202    ? *  Description: OLE - QE Program List (Window)
000500160202    ? *  Programmer.: Brian Rees
000600160202    ? *  Date.......: 02/02/2014
000700150924    ? *
000800150924    ? *  (c)Copyright 2015 by GBS, Inc.
000900150924    ? *
001000150924    ? *-------------------------------------------------------------------------
001100160202    ?FGBS0007D2 CF   E             WORKSTN
001200151006     F                                     SFILE(WSFL001:RRN)
001300150202     F                                     INFDS(WRKDS)
001400160202    ?FqePgmLst  if   e           k Disk
001500150202      //-------------------------------------------------------------------------
001600150202
001700150202     D WRKDS           DS
001800150202     D  KEY                  369    369
001900150202     D  CSRLOC               382    382
002000150202
002100150202      // Named Hex Constants For Function Keys
002200150202     D F03             C                   CONST(X'33')
002300150202     D F12             C                   CONST(X'3C')
002400150202     D ENTER           C                   CONST(X'F1')
002500150202     D rrn             s              5s 0
002600150202
002700150924     d ReLoad          s              1
002800150925     d hldSearch       S                   like(mySearch)
002900160202     d ReturnPgm       s              1
003000150924
003100150924      *--------------------------------------------
003200150924      *?Procedures
003300150924      *--------------------------------------------
003400150924     D/COPY *LIBL/QMODSRC,PR0001RPR            // Case Functions
003500150924
003600150202      * ----------------------------------------------------------------
003700150924      *?Mainline Program
003800150202      * ----------------------------------------------------------------
003900150924     C     *entry        plist
004000160202     C                   parm                    pPgmD            35
004100160202     C                   parm                    pPgmName         14
004200160202     C                   parm                    Cancel            1
004300150202
004400150202      /FREE
004500150202
004600150202       Dow key <> F12;
004700150202
004800150924             if Key =  F03 or ReturnPgm = 'Y';
004900150924                leave;
005000150924             endif;
005100150924
005200150925          if HldSearch <> mySearch or Reload = 'Y';
005300150925             HldSearch= mySearch;
005400150202             exsr CLEAR;
005500150202             exsr LOAD;
005600150202             Reload = 'N';
005700150202          Endif;
005800150202
005900150202
006000150202          exsr DISPLY;
006100150202
006200150202          // Process Selections
006300150202          Select;
006400150202
006500150202          When key = F12;
006600150202             Leave;
006700150202
006800150202          When key = ENTER and Rrn > 0;
006900150202             exsr PROCES;
007000150202             if CANCEL <> 'X';
007100150202                Leave;
007200150202             Endif;
007300150202          EndSl;
007400150202       Enddo;
007500150202
007600150202       *inlr = *on;
007700150202
007800150202      // ----------------------------------------------------------------
007900150202       BEGSR *INZSR;
008000150202
008100150202         Cancel = 'X';
008200150202         Reload = 'Y';
008300150202
008400150202         *in31 = *off;
008500150202         *in32 = *on;
008600150202         *in33 = *off;
008700150202         *in34 = *off;
008800150202
008900151006         Write W_FOOTER;
009000150202
009100150202       ENDSR;
009200150202       // ----------------------------------------------------------------
009300150202       BEGSR CLEAR;
009400150202
009500150202         *in31 = *off;
009600150202         *in32 = *off;
009700150202         *in33 = *on;
009800151123         write wctl001;
009900150202
010000150202         rrn = 0;
010100150202
010200150202         *in31 = *off;
010300150202         *in32 = *on;
010400150202         *in33 = *off;
010500150202
010600150202       ENDSR;
010700150202       // ----------------------------------------------------------------
010800150202
010900150924         Begsr Load;
011000150924
011100160202            setll *loval QePgmLst;
011200160202            dou %eof(QePgmLst);
011300160202               read QePgmLst;
011400150924
011500160202               if %Eof(QePgmLst);
011600150924                  leave;
011700150924               endif;
011800150924
011900160202                s1Pgmd = qlPgmd;
012000160202                s1PgmNam = qlPgmNam;
012100150924
012200160104
012300150924                if mySearch = *Blanks;
012400150924                   rrn = rrn + 1;
012500151006                   write WSFL001;
012600150924                endif;
012700150924
012800150924
012900150924                if mySearch > *Blanks;
013000150924                   mySearch = ucase(mySearch);
013100160202                   if %Scan( %Trim(mySearch) : uCase(s1Pgmd) ) > 0  or
013200160202                      %Scan( %Trim(mySearch) : uCase(s1PgmNam) ) > 0 ;
013300150924                      rrn = rrn + 1;
013400151006                      write WSFL001;
013500150924                   endif;
013600150924                endif;
013700150924
013800150924                if rrn >= 9999;
013900150924                   leave;
014000150924                endif;
014100150924
014200150924            enddo;
014300150924
014400150924         Endsr;
014500150202
014600150202       // ----------------------------------------------------------------
014700150202       BEGSR DISPLY;
014800150202
014900151216          if rrn = 0;
015000151216             *in31 = *off;
015100151216             Exfmt NoRcd;
015200151216             reload = 'Y';
015300151216          Endif;
015400151216
015500150202          if rrn > 0;
015600150202             *in31 = *on;
015700151216             EXFMT WCTL001;
015800151216          Endif;
015900151216
016000151216
016100150202       ENDSR;
016200150202       // ----------------------------------------------------------------
016300150202       BEGSR PROCES;
016400150202
016500150202          DOU *IN95 = *ON;
016600151006             READC WSFL001;
016700150202             *IN95 = %EOF;
016800150202
016900150202             IF *IN95 = *OFF;
017000150202
017100150924                IF wsOpt  = 1;
017200160202
017300160202                   pPgmD = s1PgmD;
017400160202                   pPgmName = s1PgmNam;
017500150924                   cancel = '';
017600150924                   ReturnPgm = 'Y';
017700150202                ENDIF;
017800150202
017900150202             ENDIF;
018000150202
018100150202          ENDDO;
018200150202       ENDSR;
018300150202
