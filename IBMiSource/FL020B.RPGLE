000100180323      *=========================================================================
000200180323     h dftactgrp(*no) option(*noDebugIo) bnddir('GBSBIND')
000300180323      *=========================================================================
000400201210      * FL020B - List Subdivisions (re-write)
000500180326      *========================================================================
000600180326      * Date         Int  Description
000700201208      * ----------   ---  -----------------------------------------------------
000800201210      * 12/10/2020   jt   Original Creation
000900180326      *========================================================================
001000180628
001100201210     ffl020bd   cf   e             WorkStn Handler('PROFOUNDUI(HANDLER)')
001101201208
001204201210     ftrsmst    if   e           k disk    extfile('F.TRSMST')
001205201210     f                                     rename(trsmsr:trustFile)
001206201208
001207201210     fsubmst    if   e           k disk    extfile('F.SUBMST')
001208201210     f                                     rename(submsr:subFile)
001209201210
001300180323      //========================================================================
001400180323
001500180323     d psds           sds
001600180323     d proc_name         *proc
001601201210     d  UserID               254    263
001602201210
001603201210     d ctrust          s              3
001604201210     d csub            s              3
001605201210     d valid           s              1
001700180323
002106201210     d runReport       pr                  extpgm('FL020CLB')
002107201210     d  ctrust                        3
002108201210     d  csub                          3
002109201210     d  userId                       10
002110201208
002200180323      //========================================================================
002300180323      // mainline
002400180323      //========================================================================
002500180323
002600180323       exsr init;
002700180323       exsr main;
002800180323       exsr exit;
002900180323
003000180323      //========================================================================
003100180323      // main
003200180323      //========================================================================
003300180323
003400180323       begsr main;
003500180323
003600180323        dow btnExit = '0';
003700180323
003701201210         exfmt screen1;
003702201210
003703201210         if btnEnter = '1';
003704201210          exsr validate;
003705201210          if valid = '0';
003706201210           exsr process;
003707201210          endif;
003708201210          btnEnter = '0';
003709201210         endif;
003710201210
004200180323        enddo;
004300180323
004400180323       endsr;
004500180323
004566201208      //========================================================================
004567201210      // valid screen
004568201208      //========================================================================
004569201208
004570201210       begsr validate;
004571201208
004572201210        errTrust = '0';
004573201210        errSub = '0';
004574201210        errSub2 = '0';
004575201210        valid = '0';
004576201210
004577201210        if strust = 0 and ssub# = 0;
004578201210         leavesr;
004579201210        endif;
004580201210
004581201210        if strust = 0 and ssub# > 0;
004582201210         errSub = '1';
004583201210          valid = '1';
004584201210         leavesr;
004585201210        endif;
004586201210
004587201210        if strust > 0 and ssub# = 0;
004588201210         chain strust trustFile;
004589201210         if not %found;
004590201210          errTrust = '1';
004591201210           valid = '1';
004592201210          leavesr;
004593201210         endif;
004594201210        endif;
004595201210
004596201210        if strust > 0 and ssub# > 0;
004597201210         chain (strust : ssub#) subFile;
004598201210         if not %found;
004599201210          errSub = '1';
004600201210           valid = '1';
004601201210           leavesr;
004602201210          endif;
004603201210         endif;
004604201210
004621201208       endsr;
004622201208
008700180323      //========================================================================
008800201210      // process
008900180323      //========================================================================
009000180323
009100201210       begsr process;
009101201210
009103201210         if strust = 0;
009104201210          ctrust = 'ALL';
009105201210        endif;
009106201210
009107201210        if ssub# = 0;
009108201210         csub = 'ALL';
009109201210        endif;
009110201210
009111201210        if strust > 0;
009112201210         ctrust = %editc(strust:'X');
009113201210        endif;
009114201210
009115201210        if ssub# > 0;
009116201210         csub = %editc(ssub#:'X');
009117201210        endif;
009118201210
009119201210        runReport(ctrust : csub : userID);
009120201210
009121201210        exfmt msgWindow;
009200180323
009600180323       endsr;
009700180323
009701201210      //========================================================================
009702201210      // exit
009703201210      //========================================================================
009704201210
009705201210       begsr exit;
009706201210
009707201210        *inlr = '1';
009708201210        return;
009709201210
009710201210       endsr;
009711201210
009800180323      //========================================================================
009900180323      // init
010000180323      //========================================================================
010100180323
010200180323       begsr init;
010201201210
010202201210        btnEnter = '0';
010600180323        btnExit = '0';
010800180323        pgmname = proc_name;
011100180323
011200180323       endsr;
011300180323
011400180323      //========================================================================
