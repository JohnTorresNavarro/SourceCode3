000100160823      *=========================================================================
000200160823     H option(*noDebugIo)
000300160823      *=========================================================================
000400160823
000500160823     Fhumanarcd if   e             disk    rename(humanarcd:mainFile)
000600160823
000700160823     Fcarplnq   if   e           k disk    rename(carplnr:planFile)
000800160823
000900160823     Fcaraccp   if   e           k disk    rename(caraccr:acctFile)
001000160823
001100160823     Fhumanatrs if a e           k disk    rename(humtrsr:outFile)
001200160823
001300160823     Fhumanatrsfo    e             disk    rename(humtrsfr:flatFile)
001400160823
001500160823     Faccmst    if   e           k disk    extfile('F.ACCMST')
001600160823     F                                     rename(accmsr:actFile)
001700160823
001800160823      //========================================================================
001900160823
002000160823    ?d exportID        s             10    inz('0000000093')
002100160823     D q               c                   const('","')
002200160823
002300160823      //========================================================================
002400160823      // mainline
002500160823      //========================================================================
002600160823
002700160823       exsr init;
002800160823       exsr main;
002900160823       exsr exit;
003000160823
003100160823      //========================================================================
003200160823      // main
003300160823      //========================================================================
003400160823
003500160823       begsr main;
003600160823
003700160823       setll 1 mainFile;
003800160823       read mainFile;
003900160823
004000160823       dow not %eof;
004100160823
004200160823       if breaklvl = '1';
004300160823
004400160823        chain (exportID : cmtrst: csubdv :cmacct) acctFile;
004500160823        if not %found;
004600160823         exsr writeRcd;
004700160823        endif;
004800160823
004900160823        if %found and castatus <> 'Y';
005000160823         exsr writeRcd;
005100160823        endif;
005200160823
005300160823       endif;
005400160823
005500160823       read mainFile;
005600160823       enddo;
005700160823
005800160823       endsr;
005900160823
006000160823      //========================================================================
006100160823      // write record
006200160823      //========================================================================
006300160823
006400160823       begsr writeRcd;
006500160823
006600160823       clear outFile;
006700160823
006800160823       htrust = %char(cmtrst);
006900160823       hsub# = %char(csubdv);
007000160823       hacct = %char(cmacct);
007100160823
007200160823       chain (cmtrst: csubdv :cmacct) actFile;
007300160823       if %found;
007400160823        hname = acnam1;
007500160823       endif;
007600160823
007700160823       chain (%char(cmtrst):%char(csubdv):%char(cmacct)) outFile;
007800160823       if not %found;
007900160823        write outFile;
008000160823
008100160823        humfld = '"' + htrust + q + hsub# + q + hacct + q + hname + q + '"';
008200160823        write flatFile;
008300160823
008400160823       endif;
008500160823
008600160823       endsr;
008700160823
008800160823      //========================================================================
008900160823      // exit
009000160823      //========================================================================
009100160823
009200160823       begsr exit;
009300160823
009400160823        *inlr = '1';
009500160823        return;
009600160823
009700160823       endsr;
009800160823
009900160823      //========================================================================
010000160823      // init
010100160823      //========================================================================
010200160823
010300160823       begsr init;
010400160823
010500160823       endsr;
010600160823
010700160823      *=========================================================================
