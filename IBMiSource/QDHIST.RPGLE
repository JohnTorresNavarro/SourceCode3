000100240403       Ctl-opt option(*noDebugIo)   DftActGrp(*no) ;
000200211020
000300211020      *-------------------------------------------------------------------------
000400211020      *
000500220502      * Declare Files
000600211020      *
000700211020      *-------------------------------------------------------------------------
000800220502
000900240409       dcl-f HISTL94 keyed usage(*input : *delete);
001000240410       dcl-f webtranL99 keyed usage(*input );
001100211020
001200211020      *-------------------------------------------------------------------------
001300211020      *
001400211020      * Global Variables
001500211020      *
001600211020      *-------------------------------------------------------------------------
001700240226
001800240226       dcl-c q const ('''');
001900240226
002000240409       dcl-s tcd  Char(3);
002100240409       dcl-s ssid Char(16);
002200240409       dcl-s grp  Char(10);
002300240409       dcl-s fld  Char(20);
002400220328
002500211026       dcl-ds pgmd
002600211026         ExtName('IOPGMD') PSDS;
002700220408         @pgmq *proc;
002800211026       end-ds;
002900211026
003000220616      *-----------------------------------------------------------------------
003100220616      *
003200220616      * *Entry Procedure
003300220616      *
003400220616      *-----------------------------------------------------------------------
003500220616       Dcl-pr Main ExtPgm;
003600240409         *N  Char(1);
003700220616       End-Pr;
003800220616
003900220616       dcl-pi Main;
004000240409         pOut  Char(1);
004100220616       End-Pi;
004200220616
004300220502
004400211020      *-------------------------------------------------------------------------
004500211020      *
004600211020      * Mainline Program
004700211020      *
004800211020      *-------------------------------------------------------------------------
004900240409         tcd = 'OLE';
005000240409         setll tcd HISTL94;
005100240409         reade tcd HISTL94;
005200240409         Dou %eof(HISTL94);
005300240403
005400240409           reade tcd HISTL94;
005500240409           if %eof(HISTL94);
005600240403             leave;
005700240403           endif;
005800240403
005900240403         exsr  myBATCH;
006000240403
006100240403         Enddo;
006200240403
006300240403         *inlr = *on;
006400240403         return;
006500240403
006600240403          begsr myBATCH;
006700240409
006800240409           ssid = %trim(CK#NOT);
006900240409           grp = 'TRM_COVG';
007000240409           fld = 'DESC1';
007100240409
007200240410           chain (ssid : grp : fld )webtranl99;
007300240410           if  %found(webtranl99);
007400240409
007500240409           if %scan( 'DECLINED' : OEAFTER) > 0 ;
007600240410           if %trim(OEPRTU) = '#PRTDCL';
007700240410           delete HISTR;
007800240410           endif;
007900240226           endif;
008000240226
008100240409           endif;
008200240227
008300240403
008400240403           endsr;
