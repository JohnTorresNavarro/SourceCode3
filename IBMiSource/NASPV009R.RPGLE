000100160513      *===========================================================================
000200160512     H option(*noDebugIo)
000300160513      *===========================================================================
000400200526      * NASPV009R - Nasco - Generate extract (Header and Trailer) - Pivot
000500180313      *================================================================================
000600180313      * Date        Int   Description
000700180313      * ----------  ---   -------------------------------------------------------------
000800200526      * 05/27/2020  jt    Original creation
000801220111      * 01/11/2022  jt    Added new field to trailer file
000900160513      *===========================================================================
001000160512
001300200526     fnaspvaheado    e             disk    rename(headar:acctHead)
001400180824
001500200526     fnaspvdtl  if   e           k disk    rename(detailr:nascoFile)
001600180824
001900200526     fnaspvtrailo    e             disk    rename(trailr:fileTrail)
002000180824
002100160512      *=================================================================
002200061017
002300180824     d datetime        s             14
002400220111     d today           s              8  0
002500180824     d time            s              6  0
002700220111     d totalrecords2   s             10  0
002800220111
002900200526     d naspv009r       pi
003000180824     d  action                       11    const
003100180824
003200160511      //==================================================================
003300160511      // mainline
003400160511      //===================================================================
003500150820
003600160511       exsr init;
003700160511       exsr main;
003800160511       exsr exit;
003900160511
004000160511      //===================================================================
004100160511      // main
004200160511      //===================================================================
004300160511
004400160511       begsr main;
004500160511
004600180824        select;
005000180824         when action = 'ACCTHEADER';
005100180824          exsr acctHeader;
005200180824
005600180824         when action = 'FILETRAILER';
005700180824          exsr fileTrailer;
005800180824        endsl;
005900180824
006000160511       endsr;
006100160511
008100180824      //===================================================================
008200180824      // account header
008300180824      //===================================================================
008400180824
008500180824       begsr acctHeader;
008600180824
008700180824        ahrtype = '10';
008800180913        ahftype = 'PF';
008900200526        ahgrpname = 'PT Network';
009000200526        ahgrptaxid = '462721480';
009100200526        ahcontact = 'CAROL FABISZAK';
009200180824        ahcntcphn# = ' ';
009300180824        ahdatesbm = %editc(%dec(%char(%date(today:*iso):*usa0):8:0):'X');
009400180824        ahmbrtrmdt = ' ';
009500180824        ahsales# = ' ';
009600180824        ahpcpind = ' ';
009700180824        ahrsubmitt = ' ';
009800180824        ahrsubmdt = ' ';
009900180824        ahrnwind = 'N';
010000180824        ahgrptype = ' ';
010100180824        ahfiller = ' ';
010200180824        ahhold = 'X';
010300180824
010400180824        write acctHead;
010500180824
010600180824       endsr;
010700180824
013400180824      //===================================================================
013500180824      // file trailer
013600180824      //===================================================================
013700180824
013800180824       begsr fileTrailer;
013900180824
014000180824        setll *loval nascoFile;
014100180824        read nascoFile;
014200180824
014300180824        dow not %eof;
014400180824
014500180824         totalRecords2 = totalrecords2 + 1;
014600180824
014700180824        read nascoFile;
014800180824        enddo;
014900180824
015000220111        trtype = '30';
015001220111        fltype = 'PF';
015100210714        //ttotalag = '000004';
015200180824        ttotalrc = %editc(totalrecords2:'X');
015300180824        tfiller = ' ';
015400180824        thold = 'X';
015500180824
015600180824        write fileTrail;
015700180824
015800180824       endsr;
015900180824
016000160511      //===================================================================
016100160511      // exit
016200160511      //===================================================================
016300160511
016400160511       begsr exit;
016500160511
016600160511        *inlr = '1';
016700160511        return;
016800160511
016900160511       endsr;
017000160511
017100160511      //===================================================================
017200160511      // init
017300160511      //===================================================================
017400160520
017500160511       begsr init;
017600180309
017700180824        time = %dec(%time);
017800160519        today = %dec(%char(%date:*iso0):8:0);
017900180824        datetime = %editc(%dec(%char(%date(today:*iso):*usa0):8:0):'X') +
018000180824                   %editc(time:'X');
018100160511       endsr;
018200010412
018300160511       //==============================================================
