000100170522      *========================================================================
000200210723     H dftactgrp(*no) option(*noDebugIo)
000300170522      *========================================================================
000400170522      * EDTRELETR - EDT Renewal Letter
000500170522      *========================================================================
000600170522      *   Created by:  J. Torres - March 26, 2015
000700170522      *========================================================================
000800170522
000900170522
001000210723     Fplnunique2if   e           k disk    rename(plnmsr:planFile2)
001001210723
001002210723     Fplnunique if   e           k disk    rename(plnmsr:planFile)
001200170522
001300210723     Fnewplan   uf a e           k disk    rename(nplanr:outFile)
001500170522
001600170522      //=======================================================================
001700170522
001800210723     d pTrustd         s              3  0
001801210805     d pSubd           s              3  0
001802210805     d*pSubd           s              3  0 inz(5)
001803210805     d count           s              5  0
001900170522
001901210723     d newplanr        pi
001902210723     d  pTrust                        3
001903210723     d  pSub#                         3
001904210723     d  pPlan                         4
001905210723     d  type                          1
001907210723
002000170522      //=======================================================================
002100170522      // mainline
002200170522      //=======================================================================
002300170522
002400170522       exsr init;
002500170522       exsr main;
002600170522       exsr exit;
002700170522
002800170522       //=======================================================================
002900170522       // main subr
003000170522       //=======================================================================
003100170522
003200170522       begsr main;
003201210723
003202210723        if type = '1';
003203210723         exsr first;
003204210723        endif;
003205210723
003206210723        if type = '2';
003207210723         exsr second;
003208210723        endif;
003301210723
005100170522       endsr;
005200170522
005300170522       //=======================================================================
005400170522       // exit subr
005500170522       //=======================================================================
005600170522
005700210723       begsr first;
005800170522
005801210723        if pPlan = ' ';
005802210723         pPlan = 'AAAA';
005803210723        endif;
005804210723
005805210805        count = 0;
005806210805
005807210723        setll pPlan planFile2;
005808210723        read planFile2;
005809210805        dow not %eof;
005810210805
005811220602         if count = 20000;
005812210805          leavesr;
005813210805         endif;
005814210805
005815210723         chain plplan outFile;
005816210723         if not %found;
005817210723          nplan = plplan;
005818210805          count = count + 1;
005819210723          write outFile;
005820210723         endif;
005821210723
005822210723        read planFile2;
005823210723        enddo;
005824210723
006200170522       endsr;
006300170522
006301210723       //=======================================================================
006302210723       // exit subr
006303210723       //=======================================================================
006304210723
006305210723       begsr second;
006306210723
006307210723        pTrustd = %dec(pTrust:3:0);
006308210723        pSubd = %dec(pSub#:3:0);
006309210723
006310210723        setll *loval outFile;
006311210723        read outFile;
006312210723        dow not %eof;
006313210723
006314210723         chain (pTrustd : pSubd : nplan) planFile;
006315210723         if %found;
006316210723          delete outfile;
006317210723         endif;
006318210723
006319210723        read outFile;
006320210723        enddo;
006322210723
006323210723       endsr;
006324210723
006325210723       //=======================================================================
006326210723       // exit subr
006327210723       //=======================================================================
006328210723
006329210723       begsr exit;
006330210723
006331210723        *inlr = '1';
006332210723        return;
006333210723
006334210723       endsr;
006335210723
006400170522       //=======================================================================
006500170522       // init subr
006600170522       //=======================================================================
006700170522
006800170522       begsr init;
006900170522
007000170522       endsr;
007100170522
007200170522       //=======================================================================
