000100000327    ? *? COMPILE:
000200000407    ? *?   CRTBNDRPG  PGM(&O/&N) SRCFILE(&L/&F) DFTACTGRP(*NO) DBGVIEW(*SOURCE)
000300000000    ? *?________________________________________________________________________
000400000000    ? *?
000500000410    ? *? Description:  Display AACODE file
000600000000    ? *?
000700000000    ? *? (c)Copyright 1999 by Inovative Outsourcing, Inc.
000800000000    ? *? This document contains restricted materials of IO, Inc.
000900000000    ? *?
001000000000    ? *? History:
001100000000    ? *?________________________________________________________________________
001200000410    ?FFM144D    CF   E             WORKSTN
001300000000     F                                     INFDS(DSPD)
001400000207     FTMPREF    IF   E             DISK
001500000000    ? *?________________________________________________________________________
001600000210    ?D WAF             S             40    DIM(30) CTDATA PERRCD(1)
001700000210    ?D WAD             S             80    DIM(6)
001800000210    ?D WTM             S             80    DIM(3) CTDATA PERRCD(1)
001900000113     D ISO_DATE        S               D   DATFMT(*ISO)
002000000113     D USA_DATE        S               D   DATFMT(*USA)
002100000328    ? *?________________________________________________________________________
002200000328    ? *?PROCEDURES
002300000308      /COPY QGPL/QRPGLESRC,FUNCT_PR#
002400000308      /COPY QGPL/QRPGLESRC,SNDRPG_PR#
002500000308      /COPY QGPL/QRPGLESRC,SNDMSG_PR#
002600020425      /COPY GBSPGM/QRPGLESRC,FM149#
002700000000    ? *?
002800000327    ? *?Data structure
002900000410    ?D WDDATA        E DS                  EXTNAME(FM140W)
003000000000    ? *?
003100000000    ? *?Program status data structure
003200991108    ?D PGMD          ESDS                  EXTNAME(IOPGMD)
003300000000    ? *?
003400000000    ? *?Display file data structure
003500991108    ?D DSPD          E DS                  EXTNAME(IODSPD)
003600000000    ? *?________________________________________________________________________
003700000000    ? *?Process display panel
003800000210     C                   EXSR      PRPPNL
003900000000    ? *?
004000000210    ?C                   DOU       WWSTT =  'END'
004100000215     C                   EXSR      RCVMSG
004200000210     C                   EXSR      DSPPNL
004300000201     C                   EXSR      PRCFKY
004400000127    ? *?
004500000119     C                   SELECT
004600000119
004700000210     C                   WHEN      WWFKA = 'ENTER '
004800000119     C                   EXSR      PRCENT
004900000119
005000000210     C                   WHEN      WWFKA = 'ROLLUP'
005100000119     C                   EXSR      PRCRUP
005200000119
005300000210     C                   WHEN      WWFKA = 'ROLLDOWN'
005400000119     C                   EXSR      PRCRDN
005500000119
005600000210     C                   WHEN      WWFKA = 'EXIT'
005700000119     C                   EXSR      PRCRTN
005800000119
005900000210     C                   WHEN      WWFKA = 'CANCEL'
006000000119     C                   EXSR      PRCCNL
006100000119
006200000210     C                   WHEN      WWFKA = 'KEYS'
006300000119     C                   EXSR      PRCDKY
006400000210     C                   ENDSL
006500000127    ? *?
006600000210    ?C                   ENDDO
006700000216     C                   EVAL      *INLR = *ON
006800000210     C                   RETURN
006900000000    ? *?__________________________________________________________________
007000000000    ? *?Prepare display panel
007100000000    ? *?__________________________________________________________________
007200000210     C     PRPPNL        BEGSR
007300000000    ? *?
007400000210     C                   MOVE      *BLANKS       WWIN
007500000210     C                   MOVE      *BLANKS       WWSTT
007600000210     C                   MOVE      *BLANKS       WORTN
007700000128     C                   EVAL      WWPNL  = 1
007800000322    ? *?NUMBER OF PANELS
007900000327     C                   EVAL      WWPNLN = 1
008000000119     C                   EVAL      WWFKS  = 1
008100000119     C                   EVAL      WW     = *ZERO
008200000000    ? *?
008300000201     C                   EXSR      BLDFKY
008400000131    ? *?__________________________________________________________________
008500000131    ? *?Get record
008600000131    ? *?__________________________________________________________________
008700000131     C                   EVAL      FUNCTION = 'GETNL   '
008800000131     C                   CALLP     UPDAT
008900000113     C                   IF        WWRTN <> *BLANKS
009000000210     C                   MOVE      WTM(1)        WWMSG
009100000131    ? *?__________________________________________________________________
009200000131    ? *?Send message
009300000131    ? *?__________________________________________________________________
009400000215     C                   CALLP     SNDMSG
009500000210     C                   MOVE      'ERROR   '    WORTN
009600000210     C                   MOVE      'END'         WWSTT
009700000210     C                   END
009800000210     C                   ENDSR
009900000215      *?__________________________________________________________________
010000000215     C     RCVMSG        BEGSR
010100000215     C                   MOVEA     *IN           WWIN
010200000215    ?C                   CALL      'PRCMSG2'
010300000215     C                   PARM      'RECEIVE '    WWRQS
010400000215     C                   PARM                    WWIN
010500000215     C                   PARM                    WWRTN
010600000215     C                   MOVEA     WWIN          *IN
010700000215     C                   ENDSR
010800000000    ? *?__________________________________________________________________
010900000000    ? *?Display the display panel
011000000000    ? *?__________________________________________________________________
011100000210     C     DSPPNL        BEGSR
011200000000    ? *?
011300000000    ? *?Set OVERLAY based on last display file processed
011400000113     C                   IF        WQPGMN <> WUPGM
011500000114     C                   EVAL      *IN35 = *OFF
011600000210     C                   MOVE      WQPGMN        WUPGM
011700000210    C                   ELSE
011800000114     C                   EVAL      *IN35 = *ON
011900000210     C                   END
012000000000    ? *?
012100000000    ? *?Write message subfile
012200000114     C                   EVAL      *IN30 = *ON
012300000210    ?C                   WRITE     MSGSFLC
012400000000    ? *?
012500000000    ? *?Write display panels
012600000127     C                   SELECT
012700000210     C                   WHEN      WWPNL = 1
012800000210    ?C                   EXFMT     DSPPNL1
012900000119
013000000327     C*                  WHEN      WWPNL = 2
013100000327    ?C*                  EXFMT     DSPPNL2
013200000119
013300000210     C                   ENDSL
013400000210     C                   ENDSR
013500000000    ? *?__________________________________________________________________
013600000000    ? *?Build function key information
013700000000    ? *?__________________________________________________________________
013800000201     C     BLDFKY        BEGSR
013900000128     C                   EVAL      FUNCTION = 'BUILD   '
014000000128     C                   CALLP     FUNCT
014100000000    ? *?
014200000113     C                   EVAL      WW = WWFKS + WWFKS
014300000210     C                   MOVEL     WAD(WW)       WSFKD2
014400000113     C                   EVAL      WW = WW - 1
014500000210     C                   MOVEL     WAD(WW)       WSFKD1
014600000210     C                   ENDSR
014700000000    ? *?__________________________________________________________________
014800000000    ? *?Process function keys
014900000000    ? *?__________________________________________________________________
015000000201     C     PRCFKY        BEGSR
015100000128     C                   EVAL      FUNCTION = 'PROCESS '
015200000128     C                   CALLP     FUNCT
015300000210     C                   ENDSR
015400000000    ? *?__________________________________________________________________
015500000000    ? *?Process KEYS function
015600000000    ? *?__________________________________________________________________
015700000210     C     PRCDKY        BEGSR
015800000113     C                   EVAL      WW = 1
015900000210    ?C                   DOU       WWFKS = 1 OR
016000000210     C                             WAD(WW) <> *BLANKS
016100000127    ? *?
016200000113     C                   EVAL      WWFKS = WWFKS + 1
016300000210     C                   IF        WWFKS > 3
016400000113     C                   EVAL      WWFKS = 1
016500000210     C                   END
016600000127    ? *?
016700000113     C                   EVAL      WW = (WWFKS * 2) - 1
016800000210    ?C                   ENDDO
016900000000    ? *?
017000000113     C                   EVAL      WW = WWFKS + WWFKS
017100000210     C                   MOVEL     WAD(WW)       WSFKD2
017200000113     C                   EVAL      WW = WW - 1
017300000210     C                   MOVEL     WAD(WW)       WSFKD1
017400000000    ? *?
017500000210     C                   ENDSR
017600000000    ? *?__________________________________________________________________
017700000000    ? *?Process RETURN function
017800000000    ? *?__________________________________________________________________
017900000210     C     PRCRTN        BEGSR
018000000210     C                   MOVEL     WWFKA         WORTN
018100000210     C                   MOVE      'END'         WWSTT
018200000210     C                   ENDSR
018300000000    ? *?__________________________________________________________________
018400000000    ? *?Process CANCEL function
018500000000    ? *?__________________________________________________________________
018600000210     C     PRCCNL        BEGSR
018700000216     C                   MOVE      *BLANKS       WORTN
018800000216     C                   MOVE      'END'         WWSTT
018900000201     C                   ENDSR
019000000000    ? *?__________________________________________________________________
019100000000    ? *?Process ROLLUP function
019200000000    ? *?__________________________________________________________________
019300000210     C     PRCRUP        BEGSR
019400000113     C                   EVAL      WWPNL = WWPNL + 1
019500000113     C                   IF        WWPNL > WWPNLN
019600000113     C                   EVAL      WWPNL = WWPNL - 1
019700000210     C                   END
019800000210     C                   ENDSR
019900000000    ? *?__________________________________________________________________
020000000000    ? *?Process ROLLDOWN function
020100000000    ? *?__________________________________________________________________
020200000210     C     PRCRDN        BEGSR
020300000113     C                   EVAL      WWPNL = WWPNL - 1
020400000113     C                   IF        WWPNL < 1
020500000113     C                   EVAL      WWPNL = WWPNL + 1
020600000210     C                   END
020700000210     C                   ENDSR
020800000000    ? *?__________________________________________________________________
020900000000    ? *?Process ENTER function
021000000000    ? *?__________________________________________________________________
021100000210     C     PRCENT        BEGSR
021200000210     C                   MOVE      *BLANKS       WORTN
021300000210     C                   MOVE      'END'         WWSTT
021400000210     C                   ENDSR
021500000000    ? *?__________________________________________________________________
021600000000    ? *?Parameter lists
021700000000    ? *?__________________________________________________________________
021800000210     C     PLIST         BEGSR
021900000210     C     *ENTRY        PLIST
022000000210     C     WWTSK         PARM                    WIRQS
022100000210     C                   PARM                    WORTN
022200000210     C                   PARM                    WUPGM
022300000327     C                   PARM                    WDDATA
022400000210     C                   PARM                    WWFKY
022500000210     C                   ENDSR
022600000000    ? *?__________________________________________________________________
022700000000    ? *?Initialize routine
022800000000    ? *?__________________________________________________________________
022900000210     C     *INZSR        BEGSR
023000000210     C                   MOVEL     '*'           MSPGMQ
023100000210     C                   ENDSR
023200000000    ? *?__________________________________________________________________
023300000000    ? *?Program error handler
023400000000    ? *?__________________________________________________________________
023500000215     C*?   *PSSR         BEGSR
023600000215     C*?                 CALLP     SNDRPG
023700000215     C*?                 ENDSR     '*CANCL'
023800000000    ? *?__________________________________________________________________
023900000131    ? *?PROCEDURES
024000000308      /COPY QGPL/QRPGLESRC,FUNCT#
024100000308      /COPY QGPL/QRPGLESRC,SNDRPG#
024200000308      /COPY QGPL/QRPGLESRC,SNDMSG#
024300020425      /COPY GBSPGM/QRPGLESRC,FM149
024400000000    ? *?__________________________________________________________________
024500000000**  WAF FUNCTION KEY TABLE - 30X40      |INDICATOR 2.0, ACTION8A, DESCR 30A    |
02460000032703EXIT    F3=Exit
02470000032712CANCEL  F12=Cancel
02480000000025ROLLUP
02490000000026ROLLDOWN
025000000000** WTM
02510000032700File not found.
