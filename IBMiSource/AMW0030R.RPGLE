000100191203       Ctl-opt option(*noDebugIo)   DftActGrp(*no) ;
000200191115
000300191115      *-------------------------------------------------------------------------
000400220411      *
000500221024      *  Description: Get First Received OE File
000600211216      *  Programmer.: Jon Allen
000700221024      *  Date.......: 10/24/2022
000800191115      *
000900191203      *
001000191115      *-------------------------------------------------------------------------
001100230217       dcl-f amw0001lf usage( *Input ) keyed;
001200230217       dcl-f amw0006l1 usage( *Input ) keyed;
001300191115
001400191115      *-------------------------------------------------------------------------
001500191115      *
001600191115      * *Entry Procedure
001700191115      *
001800191115      *-------------------------------------------------------------------------
001900191115       Dcl-pr Main ExtPgm;
002000221024         *N  Char(10);
002100221024         *N  Char(300);
002200221024         *N  Char(1);
002300191115       End-Pr;
002400191115
002500191115       dcl-pi Main;
002600221024         pTSA      Char(10);
002700221024         pFirstFile Char(300);
002800221024         pCont Char(1);
002900191115       End-Pi;
003000191115
003100191115
003200191115      *-------------------------------------------------------------------------
003300191115      *
003400191115      * Mainline Program
003500191115      *
003600191115      *-------------------------------------------------------------------------
003700211216
003800230217       A6TRUST = %dec(%subst(pTSA:1:3):3:0);
003900230217       A6SUBNO = %dec(%subst(pTSA:4:3):3:0);
004000230217       A6ACCTN = %dec(%subst(pTSA:7:4):4:0);
004100230217
004200230217           chain (a6Trust:A6Subno:A6Acctn) amw0006l1;
004300230217           if %Found( amw0006l1 ) ;
004400230217            setgt (a6Trust:A6Subno:A6Acctn) amw0001lf;
004500230217            readpe (a6Trust:A6Subno:A6Acctn) amw0001lf;
004600230217            dow not %eof(amw0001lf);
004700230217              If   A6OPENED = A1RCVDATE;
004800230221      //   pFirstFile = %Trim(A1FOLDPATH) + '/Archive/' + %trim(A1FILENAME);
004900230221           pFirstFile = %Trim(A1FOLDPATH) + %trim(A1FILENAME);
005000230217           pcont = 'Y';
005100230217           Leave;
005200230217              EndIf;
005300230217            readpe (a6Trust:A6Subno:A6Acctn) amw0001lf;
005400230217           enddo;
005500230217           EndIf;
005600220412
005700191115       *inlr = *on;
