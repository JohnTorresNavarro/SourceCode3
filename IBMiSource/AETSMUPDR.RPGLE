000100190401      *========================================================================
000102190401       Ctl-opt option(*noDebugIo) dftactgrp(*no);
000103190401      *========================================================================
000104200316      * AETSMUPDR - Aetna - File Upload - Small groups
000105190401      *========================================================================
000106190401      * Date         Int  Description
000107190401      * ---------    ---  -----------------------------------------------------
000108200316      * 03/16/2020   jt   Original Creation
000109190401      *========================================================================
000110190401
000116200316       Dcl-f aetsmupdd WorkStn Handler('PROFOUNDUI(HANDLER)');
000123190401
000124190401      *========================================================================
000125190401
000126190401       dcl-ds UploadFile Qualified;
000128190401         NumFiles Zoned(3);
000129190401         Directory Char(256);
000130190401         Files Char(256);
000131190401       End-Ds;
000132190401
000133190401       dcl-s myFileName Char(256) ;
000134190401
000135190401     d psds           sds
000136190401     d proc_name         *proc
000137190401     d user                  254    263
000138190401
000141200316     d aetsmupdc       pr                  ExtPgm('AETSMUPDC')
000142200316     d
000143200316
000146190401      //======================================================================
000147190401      // mainline
000148190401      //======================================================================
000149190401
000150190401       exsr init;
000151190401       exsr main;
000152190401       exsr exit;
000153190401
000154190401      //======================================================================
000155190401      // moin
000156190401      //======================================================================
000157190401
000158190401       begsr main;
000159190401
000162190401        Dow btnExit = '0';
000163200316
000164190401         Exfmt Screen1;
000165200316
000166200316         if btnAccept = '1';
000167200316          exsr uploadRecords;
000168200316         endif;
000169200316
000170200316         if btnAccept2 = '1';
000171200316          exfmt msgWindow2;
000172200316          btnAccept2 = '0';
000174200316         endif;
000175200316
000176190401        enddo;
000177190401
000178190401       endsr;
000179200316
000180200316      //======================================================================
000181200316      // upload records;
000182200316      //======================================================================
000183200316
000184200316       begsr uploadRecords;
000185200316
000186200316        btnCancel = '0';
000187200316        btnAccept2 = '0';
000188200316
000189200316        dow btnCancel = '0';
000190200316
000191200316         exfmt msgWindow;
000192200316
000193200316         if btnAccept2 = '1';
000194200316          myFileName = UploadFile.Files;
000195200316           aetsmupdc();
000196200316          btnCancel = '1';
000197200316         endif;
000198200316
000199200316        enddo;
000200200316
000201200316       endsr;
000202190401
000203190401      //======================================================================
000204190401      // exit
000205190401      //======================================================================
000206190401
000207190401       begsr exit;
000208190401
000209190401        *inlr = '1';
000210190401        return;
000211190401
000212190401       endsr;
000213190401
000214190401      //======================================================================
000215190401      // init
000216190401      //======================================================================
000217190401
000218190401       begsr init;
000219190401
000220200316        btnExit = '0';
000221200316        btnCancel = '0';
000222200316        btnAccept = '0';
000223200316        btnAccept2 = '0';
000224200316
000225190401        pgmname = proc_name;
000226200316        title = 'Aetna Small Groups Upload File';
000227190401        btnExit = '0';
000229190401
000230190401       endsr;
000231190401
000232190401      //======================================================================
