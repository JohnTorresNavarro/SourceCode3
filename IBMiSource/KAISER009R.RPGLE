000100160513      *===========================================================================
000200160512     H option(*noDebugIo)
000300160513      *===========================================================================
000400180823      * NASCO010R - Nasco - Generate extract
000500180313      *================================================================================
000600180313      * Date        Int   Description
000700180313      * ----------  ---   -------------------------------------------------------------
000800180823      * 08/23/2018  jt    Original creation
000900160513      *===========================================================================
001000160512
001100181029     fkaiserhdr o    e             disk    rename(headfr:fileHead)
001200180824
001300181108     fkaiserdtlxif   e           k disk    rename(kaiserdr:kaiserFile)
001400180824
001500181029     fkaisertrl o    e             disk    rename(trailr:fileTrail)
001600180824
001700160512      *=================================================================
001800061017
001900180824     d datetime        s             14
002000160519     d today           s              8  0
002100180824     d time            s              6  0
002200181108     d totalrecords    s              5  0
002300180824
002400181029     d kaiser009r      pi
002500180824     d  action                       11    const
002600180824
002700160511      //==================================================================
002800160511      // mainline
002900160511      //===================================================================
003000150820
003100160511       exsr init;
003200160511       exsr main;
003300160511       exsr exit;
003400160511
003500160511      //===================================================================
003600160511      // main
003700160511      //===================================================================
003800160511
003900160511       begsr main;
004000160511
004100181030        exsr recordCount;
004200181030
004300180824        select;
004400180824         when action = 'FILEHEADER';
004500180824          exsr fileHeader;
004600180824
004700180824         when action = 'FILETRAILER';
004800180824          exsr fileTrailer;
004900180824        endsl;
005000180824
005100160511       endsr;
005200160511
005300181030      //===================================================================
005400181030      // record count
005500181030      //===================================================================
005600181030
005700181030       begsr recordCount;
005800181030
005900181030        setll *loval kaiserFile;
006000181030        read kaiserFile;
006100181030
006200181030        dow not %eof;
006300181030
006400181030         totalRecords = totalRecords + 1;
006500181030
006600181030        read kaiserFile;
006700181030        enddo;
006800181030
006900181030        khrcount = %editc(totalrecords:'X');
007000181030        ktrcount = %editc(totalrecords:'X');
007100181030
007200181030       endsr;
007300181030
007400180309      //===================================================================
007500180824      // file header
007600180309      //===================================================================
007700180309
007800180824       begsr fileHeader;
007900180309
008000181029        khrid = 'H';
008100181030        khgrpname = 'Group Benefit Services';
008200181030        khfcreate = datetime;
008300181030        khfp = 'P';
008400180824
008500180824        write fileHead;
008600180309
008700180309       endsr;
008800180824
008900180824      //===================================================================
009000180824      // file trailer
009100180824      //===================================================================
009200180824
009300180824       begsr fileTrailer;
009400180824
009500181030        ktrid = 'F';
009600181030        ktgrpname = 'Group Benefit Services';
009700181030        ktfcreate = datetime;
009800181030        ktfp = 'P';
009900181030
010000181030        write fileTrail;
010100181030
010200180824       endsr;
010300180824
010400160511      //===================================================================
010500160511      // exit
010600160511      //===================================================================
010700160511
010800160511       begsr exit;
010900160511
011000160511        *inlr = '1';
011100160511        return;
011200160511
011300160511       endsr;
011400160511
011500160511      //===================================================================
011600160511      // init
011700160511      //===================================================================
011800160520
011900160511       begsr init;
012000180309
012100180824        time = %dec(%time);
012200160519        today = %dec(%char(%date:*iso0):8:0);
012300181030        datetime = %editc(%dec(%char(%date(today:*iso):*usa0):8:0):'X') +
012400181030                   %editc(time:'X');
012500181029
012600160511       endsr;
012700010412
012800160511       //==============================================================
