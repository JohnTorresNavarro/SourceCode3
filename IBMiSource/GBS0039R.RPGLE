000100180718       Ctl-opt option(*noDebugIo)   DftActGrp(*no);
000200180718
000300180718      *-------------------------------------------------------------------------
000400180718      *
000500180920      *  Description: Compare Payroll file with iSeries - Driver Program
000600180718      *  Programmer.: Brian Rees
000700180920      *  Date.......: 09/20/2018
000800180723      *
000900180723      *
001000180718      *-------------------------------------------------------------------------
001100180718
001200180718      *-------------------------------------------------------------------------
001300180718      *
001400180718      * Declare Files
001500180718      *
001600180718      *-------------------------------------------------------------------------
001700180920       Dcl-f GBS0039d WorkStn
001800180718          Handler('PROFOUNDUI(HANDLER)');
001900180718
002000180718
002100180718
002200180718
002300180718
002400180718      *-------------------------------------------------------------------------
002500180718      *
002600180718      * Global Variables
002700180718      *
002800180718      *-------------------------------------------------------------------------
002900180718       dcl-ds uploadFile Qualified;
003000180718          numFiles Zoned(3);
003100180718          Directory Char(256);
003200180718          Files Char(256);
003300180718       End-Ds;
003400180718
003500180718       dcl-s hasError ind;
003600180718
003700201110       dcl-pr GBS_FORMAT20 ExtPgm('GBS0039C4');
003800201117          *N Char(10) ;
003900210627          *N Char(40) ;
004000201110       End-Pr;
004100180724
004200180920       //dcl-pr SF_FORMAT  ExtPgm('GBS0038C2') ;
004300180920       //   *n Char(40);
004400180920       //End-Pr;
004500180724
004600180920       dcl-pr ADP_FORMAT ExtPgm('GBS0039C2') ;
004700180920          *n Char(10);
004800180724       End-Pr;
004900180719
005000180719
005100180718
005200180719      *-------------------------------------------------------------------------
005300180719      *
005400180719      * *Entry Procedure
005500180719      *
005600180719      *-------------------------------------------------------------------------
005700180719       Dcl-pr Main ExtPgm;
005800180719          *N  Char(10);
005900180719          *N  Char(40);
006000180920          *N  Char(10);
006100180719       End-Pr;
006200180719
006300180719       dcl-pi Main;
006400180719          pFileType Char(10);
006500180719          pName     Char(40);
006600180920          pKey      Char(10);
006700180719       End-Pi;
006800180719
006900180920
007000180719
007100180718      *-------------------------------------------------------------------------
007200180718      *
007300180718      * Mainline Program
007400180718      *
007500180718      *-------------------------------------------------------------------------
007600180724       s1FileType = pFileType;
007700180724       if pFileType = 'GBS-FI';
007800180724          s1FileType = 'GBS Format - Fully Insurred';
007900180724       EndIf;
008000180719
008100201110       if pFileType = 'GBS20-FI';
008200201110          s1FileType = 'GBS Format 2.0 - Fully Insurred';
008300201110       EndIf;
008400201110
008500180724       if pFileType = 'GBS-Sf';
008600180724          s1FileType = 'GBS Format - Self Funded';
008700180724       EndIf;
008800180719
008900180724       if pFileType = 'ADP';
009000180724          s1FileType = 'ADP Format';
009100180724       EndIf;
009200180718
009300180719
009400180719
009500180719
009600180724       Dou btnExit = *on;
009700180724          Exfmt Screen1;
009800180718
009900180724          if btnExit = *on;
010000180724             leave;
010100180724          endif;
010200180718
010300180718
010400180724          Validate();
010500180724          if hasError = *on;
010600180724             iter;
010700180724          EndIf;
010800180718
010900180724          if btnAccept = *on;
011000180718
011100180724             if pFileType = 'GBS-FI';
011200180920           //   GBS_Format(pName);
011300180724             endif;
011400180723
011500210627            pName = %ScanRpl('''' : '' : pName);
011600210627            pName = %ScanRpl(' ' : '_' :  %trim(pName));
011700210627
011800210627
011900210627
012000210627
012100201110             if pFileType = 'GBS20-FI';
012200210627              GBS_Format20(pKey:pName);
012300210627              leave;
012400201110             endif;
012500201110
012600180724             if pFileType = 'GBS-SF';
012700180920          //    SF_Format(pName);
012800180724             endif;
012900180723
013000180724             if pFileType = 'ADP';
013100180920                ADP_Format( pKey );
013200180724             endif;
013300180723
013400180724          EndIf;
013500180718
013600180724       enddo;
013700180718
013800180718
013900180718       *inlr = *on;
014000180718
014100180718       // ----------------------------------------------------------------
014200180718       dcl-proc validate;
014300180718
014400180724          hasError = *off;
014500180724          errFile = *off;
014600180718
014700180718
014800180724          if uploadFile.Files = '';
014900180724             hasError = *on;
015000180724             errFile = *on;
015100180724          EndIf;
015200180718
015300180718
015400180718       end-proc;
015500180718
