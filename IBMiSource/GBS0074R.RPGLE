000100210707
000200210607       Ctl-opt option(*nodebugio:*srcstmt:*nounref)   DftActGrp(*no);
000300210607
000400210607      *-------------------------------------------------------------------------
000500210607      *
000600210815      *  Description: Payroll File Statistics
000700210607      *  Programmer.: Brian Rees
000800210815      *  Date.......: 08/15/2021
000900210607      *
001000210607      *-------------------------------------------------------------------------
001100210607
001200210607      *-------------------------------------------------------------------------
001300210607      *
001400210607      * Declare Files
001500210607      *
001600210607      *-------------------------------------------------------------------------
001700210815       Dcl-f AccMst keyed ExtDesc('F.ACCMST') ExtFile(*extdesc);
001800210815       dcl-f Gbs0074p keyed usage(*output);
001900210815       dcl-f PayfSts keyed;
002000210815
002100210607
002200210607      *-------------------------------------------------------------------------
002300210607      *
002400210607      * Global Variables
002500210607      *
002600210607      *-------------------------------------------------------------------------
002700210607       dcl-ds pgmd
002800210607          ExtName('IOPGMD') PSDS;
002900210706         @pgmq *proc;
003000210607       end-ds;
003100210607
003200210607
003300210607
003301210913       dcl-s Yesterday Zoned(8);
003302210913       dcl-s Last_Sunday Zoned(8);
003400210607
003500210607
003600210607      *-------------------------------------------------------------------------
003700210607      *
003800210607      * Mainline Program
003900210607      *
004000210607      *-------------------------------------------------------------------------
004100210607
004200210815       Setll *loval payfsts;
004300210815
004301210913       Yesterday = %Dec( %Date - %Days(1) ) ;
004302210913       Last_Sunday = %Dec( %Date - %Days(8) ) ;
004303210913
004304210913
004305210913
004400210815       Dou %Eof(payfsts);
004500210815         read payfsts;
004600210815         if %eof(payfsts);
004700210815           leave;
004800210815         endif;
004801210913
004802210913
004900210815
005000210823         if psTrst > 0 and psDtlLine > 0;
005001210913
005100210913           a9trst = psTrst;
005200210913           a9sub# = psSub#;
005300210913           a9acct = psAcct;
005400210913           a9actnam = psActName;
005500210913           a9payvend = psPayVend;
005600210913           a9envir = psEnvir;
005700210913           a9aaname = psAAName;
005800210913           a9noempl = 0;
005900210913           a9FileDate = psDate;
006000210815
006100210913           chain ( psTrst : psSub# : psAcct ) AccMst;
006200210913           if %Found( AccMst ) ;
006300210913             a9NoEmpl = NoEmpl;
006400210913           EndIf;
006500210815
006600210913           a9mbrsapp = psMbrCnt;
006700210913           a9dtllines = psDtlLine;
006800210815
006801210913
006802210913           // Only Select the previous Week.
006804210913           if psDate >= Last_Sunday and psDate <= Yesterday;
006900210913             write r_Gbs0074;
007000210913           endif;
007001210913         endif;
007100210815
007200210815       Enddo;
007300210815
007400210815       *inlr=*on;
007500210815
