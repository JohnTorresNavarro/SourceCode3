000100190401      *========================================================================
000102190401       Ctl-opt option(*noDebugIo) dftactgrp(*no);
000103190401      *========================================================================
000104230403      * DW180MTRB - M&T Remote On-demand Deposit Prompt
000105190401      *========================================================================
000106190401      * Date         Int  Description
000107230330      * ----------   ---  -----------------------------------------------------
000108230403      * 04/04/2023   jt   Original Creation
000112190401      *========================================================================
000113190401
000116230403       Dcl-f dw180mtdb WorkStn Handler('PROFOUNDUI(HANDLER)');
000123190401
000124190401      *========================================================================
000125190401
000126190401       dcl-ds UploadFile Qualified;
000128190401         NumFiles Zoned(3);
000129190401         Directory Char(256);
000130190401         Files Char(256);
000132190401       End-Ds;
000133190401
000134190401       dcl-s myFileName Char(256) ;
000135190401
000136190401     d psds           sds
000137210806     d proc_name         *proc
000138190401     d user                  254    263
000141190401
000142230413     d continue        s              1
000143230413     d e1envir         s             15
000144230413     d e1libl          s             10
000145230413     d e1Lib2          s             10
000146230413     d envColor        s             10
000147230413     d e1Acnm          s             40
000148230413
000149230413     d getEnv          pr                  ExtPgm('GETENVR')
000150230413     d  e1envir                      15
000151230413     d  e1libl                       10
000152230413     d  e1Lib2                       10
000153230413     d  envColor                     10
000154230413     d  e1Acnm                       40
000155230413
000156230413     d ChkPgmAuth      pr                  extpgm('CHKPGMAUTH')
000157230413     d  pgmname                      10
000158230413     d  continue                      1
000159230413
000160230403     d dw180mtbcl      pr                  ExtPgm('DW180MTBCL')
000161230330
000162230403     d dw180mtrb       pi
000163190401
000164190401      //======================================================================
000165190401      // mainline
000166190401      //======================================================================
000167190401
000168190401       exsr init;
000169190401       exsr main;
000170190401       exsr exit;
000171190401
000172190401      //======================================================================
000173190401      // moin
000174190401      //======================================================================
000175190401
000176190401       begsr main;
000177190401
000178190401        Dow btnExit = '0';
000180230503         //rename = 'groben' + %char(%date) + %trim('.txt');
000181230330         exfmt Screen1;
000182190401
000183210120         errFile = '0';
000184190401         if btnExit = '1';
000185190401          leave;
000186190401         endif;
000187190401
000188190401         myFileName = UploadFile.Files;
000189210120
000190210120         if  UploadFile.Files > ' ';
000191230330          //type = 'Y';
000192230330           errFile = '0';
000193230403            dw180mtbcl();
000194230330            exfmt msgWindow;
000195230330           btnExit = '1';
000196210120          leavesr;
000197210120         else;
000198230330          //type = 'N';
000199210120          errFile = '1';
000200210120         endif;
000201190401
000202190401        enddo;
000203190401
000204190401       endsr;
000205190401
000206190401      //======================================================================
000207190401      // exit
000208190401      //======================================================================
000209190401
000210190401       begsr exit;
000211190401
000212190401        *inlr = '1';
000213190401        return;
000214190401
000215190401       endsr;
000216190401
000217190401      //======================================================================
000218190401      // init
000219190401      //======================================================================
000220190401
000221190401       begsr init;
000222190401
000223190401        pgmname = proc_name;
000224190401        btnExit = '0';
000225230330        //type = 'N';
000226190401
000227230413        getenv(e1envir : e1libl : e1Lib2 : envColor : e1Acnm);
000228230413
000229230413        ChkPgmAuth(pgmname : continue);
000230230413        if continue = 'N';
000231230413         exsr exit;
000232230413        endif;
000233230413
000234190401       endsr;
000235190401
000236190401      //======================================================================
